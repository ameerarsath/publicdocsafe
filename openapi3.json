{"openapi":"3.1.0","info":{"title":"SecureVault API","description":"Enterprise-grade secure document storage for small teams","version":"1.0.0"},"paths":{"/api/v1/debug/{path}":{"options":{"tags":["debug","Debug"],"summary":"Handle Options","description":"Handle all OPTIONS requests for CORS preflight.","operationId":"handle_options_api_v1_debug__path__options","parameters":[{"name":"path","in":"path","required":true,"schema":{"type":"string","title":"Path"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/debug/cors-test":{"get":{"tags":["debug","Debug"],"summary":"Cors Test","description":"Test CORS configuration.","operationId":"cors_test_api_v1_debug_cors_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/auth/login":{"post":{"tags":["authentication"],"summary":"Login","description":"Authenticate user and return JWT tokens.\n\nArgs:\n    login_data: Login request with username and password\n    request: FastAPI request object\n    db: Database session\n    redis: Redis manager\n    \nReturns:\n    LoginResponse with JWT tokens\n    \nRaises:\n    HTTPException: If authentication fails","operationId":"login_api_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/mfa/verify":{"post":{"tags":["authentication"],"summary":"Verify Mfa","description":"Complete MFA verification and return JWT tokens.\n\nArgs:\n    mfa_data: MFA verification request\n    request: FastAPI request object\n    db: Database session\n    redis: Redis manager\n    \nReturns:\n    LoginResponse with JWT tokens","operationId":"verify_mfa_api_auth_mfa_verify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAVerificationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/logout":{"post":{"tags":["authentication"],"summary":"Logout","description":"Logout user and clear session.\n\nThis endpoint handles logout gracefully even if the token is expired or invalid.\n\nReturns:\n    Success message","operationId":"logout_api_auth_logout_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/auth/refresh":{"post":{"tags":["authentication"],"summary":"Refresh Token","description":"Refresh access token using refresh token.\n\nArgs:\n    refresh_data: Token refresh request\n    db: Database session\n    \nReturns:\n    New access token","operationId":"refresh_token_api_auth_refresh_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenRefreshRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenRefreshResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/register":{"post":{"tags":["authentication"],"summary":"Zero Knowledge Register","description":"Register a new user with zero-knowledge encryption setup.\n\nThis endpoint creates a new user account with separate login and encryption credentials.\nThe server stores the encryption salt and verification payload but never sees the \nencryption password or derived keys.\n\nArgs:\n    registration_data: Registration request with login and encryption parameters\n    request: FastAPI request object\n    db: Database session\n    redis: Redis manager\n    \nReturns:\n    Registration success response\n    \nRaises:\n    HTTPException: If registration fails","operationId":"zero_knowledge_register_api_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ZeroKnowledgeRegistrationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ZeroKnowledgeRegistrationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/me":{"get":{"tags":["authentication"],"summary":"Get Current User Info","description":"Get current user information.\n\nArgs:\n    current_user: Current authenticated user\n    \nReturns:\n    User information","operationId":"get_current_user_info_api_auth_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Get Current User Info Api Auth Me Get"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/auth/register/simple":{"post":{"tags":["authentication"],"summary":"Simple Register","description":"Simplified registration endpoint that generates encryption parameters on server side.\nThis is primarily for testing and backwards compatibility.\n\nArgs:\n    username: Username for login\n    email: Email address\n    password: Login password\n    encryption_password: Separate password for encryption\n    full_name: Optional full name\n    db: Database session\n    \nReturns:\n    Registration response","operationId":"simple_register_api_auth_register_simple_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SimpleRegistrationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ZeroKnowledgeRegistrationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/mfa/setup":{"post":{"tags":["mfa","mfa"],"summary":"Setup Mfa","description":"Set up MFA for the current user.\n\nThis endpoint generates a new TOTP secret, creates a QR code for \nauthenticator app setup, and generates backup codes for recovery.\n\nReturns:\n    MFASetupResponse with secret, QR code, and backup codes\n    \nRaises:\n    HTTPException: If MFA is already enabled or password is invalid","operationId":"setup_mfa_api_v1_mfa_setup_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFASetupRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFASetupResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/mfa/verify":{"post":{"tags":["mfa","mfa"],"summary":"Verify Mfa","description":"Verify a TOTP code or backup code.\n\nThis endpoint verifies either a 6-digit TOTP code from an authenticator\napp or an 8-character backup code for MFA authentication.\n\nReturns:\n    MFAVerifyResponse with verification result\n    \nRaises:\n    HTTPException: If MFA is not enabled or code is invalid","operationId":"verify_mfa_api_v1_mfa_verify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAVerifyRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAVerifyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/mfa/status":{"get":{"tags":["mfa","mfa"],"summary":"Get Mfa Status","description":"Get MFA status for the current user.\n\nReturns information about whether MFA is enabled, when it was set up,\nand how many backup codes remain.\n\nReturns:\n    MFAStatus with user's MFA information","operationId":"get_mfa_status_api_v1_mfa_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAStatus"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/mfa/disable":{"post":{"tags":["mfa","mfa"],"summary":"Disable Mfa","description":"Disable MFA for the current user.\n\nRequires the user's current password for security. Admin users can\noverride this requirement with the admin_override flag.\n\nReturns:\n    Success message\n    \nRaises:\n    HTTPException: If password is invalid or MFA is not enabled","operationId":"disable_mfa_api_v1_mfa_disable_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFADisableRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Disable Mfa Api V1 Mfa Disable Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/mfa/backup-codes":{"post":{"tags":["mfa","mfa"],"summary":"Generate New Backup Codes","description":"Generate new backup codes for the current user.\n\nThis will replace all existing backup codes. Requires the user's\ncurrent password for security.\n\nReturns:\n    BackupCodesResponse with new backup codes\n    \nRaises:\n    HTTPException: If MFA is not enabled or password is invalid","operationId":"generate_new_backup_codes_api_v1_mfa_backup_codes_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BackupCodesRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BackupCodesResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/mfa/qr-code":{"post":{"tags":["mfa","mfa"],"summary":"Get Qr Code","description":"Generate QR code for MFA setup.\n\nThis endpoint generates a QR code in the requested format for setting\nup TOTP in an authenticator app. Only available if MFA is enabled.\n\nReturns:\n    QRCodeResponse with QR code in requested format\n    \nRaises:\n    HTTPException: If MFA is not enabled","operationId":"get_qr_code_api_v1_mfa_qr_code_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/QRCodeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QRCodeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/mfa/admin/reset":{"post":{"tags":["mfa","mfa"],"summary":"Admin Reset Mfa","description":"Reset MFA for a user (admin only).\n\nThis endpoint allows administrators to reset MFA for any user,\nwhich disables their MFA and removes all associated data.\n\nReturns:\n    MFAResetResponse with reset details\n    \nRaises:\n    HTTPException: If user not found or MFA not enabled","operationId":"admin_reset_mfa_api_v1_mfa_admin_reset_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAResetRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAResetResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/mfa/admin/stats":{"get":{"tags":["mfa","mfa"],"summary":"Get Mfa Stats","description":"Get MFA statistics (admin only).\n\nReturns system-wide MFA statistics including enrollment rates,\nbackup code usage, and recent activity.\n\nReturns:\n    MFAStatsResponse with MFA statistics","operationId":"get_mfa_stats_api_v1_mfa_admin_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAStatsResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/mfa/health":{"get":{"tags":["mfa","mfa"],"summary":"Mfa Health Check","description":"Check MFA service health.\n\nThis endpoint verifies that all MFA-related services are functioning\nproperly including TOTP generation, QR code creation, and database access.\n\nReturns:\n    MFAHealthResponse with service status","operationId":"mfa_health_check_api_v1_mfa_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MFAHealthResponse"}}}}}}},"/api/v1/rbac/roles":{"get":{"tags":["rbac","RBAC"],"summary":"List Roles","description":"List all roles with optional filtering and pagination.","operationId":"list_roles_api_v1_rbac_roles_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Page size","default":10,"title":"Size"},"description":"Page size"},{"name":"include_stats","in":"query","required":false,"schema":{"type":"boolean","description":"Include usage statistics","default":false,"title":"Include Stats"},"description":"Include usage statistics"},{"name":"active_only","in":"query","required":false,"schema":{"type":"boolean","description":"Only active roles","default":true,"title":"Active Only"},"description":"Only active roles"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["rbac","RBAC"],"summary":"Create Role","description":"Create a new role.","operationId":"create_role_api_v1_rbac_roles_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Role"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/roles/{role_id}":{"get":{"tags":["rbac","RBAC"],"summary":"Get Role","description":"Get a specific role by ID.","operationId":"get_role_api_v1_rbac_roles__role_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"role_id","in":"path","required":true,"schema":{"type":"integer","title":"Role Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Role"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["rbac","RBAC"],"summary":"Update Role","description":"Update an existing role.","operationId":"update_role_api_v1_rbac_roles__role_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"role_id","in":"path","required":true,"schema":{"type":"integer","title":"Role Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Role"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["rbac","RBAC"],"summary":"Delete Role","description":"Delete a role.","operationId":"delete_role_api_v1_rbac_roles__role_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"role_id","in":"path","required":true,"schema":{"type":"integer","title":"Role Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/permissions":{"get":{"tags":["rbac","RBAC"],"summary":"List Permissions","description":"List all permissions with optional filtering.","operationId":"list_permissions_api_v1_rbac_permissions_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"size","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"description":"Page size","default":50,"title":"Size"},"description":"Page size"},{"name":"resource_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by resource type","title":"Resource Type"},"description":"Filter by resource type"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["rbac","RBAC"],"summary":"Create Permission","description":"Create a new permission.","operationId":"create_permission_api_v1_rbac_permissions_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Permission"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/users/{user_id}/roles":{"get":{"tags":["rbac","RBAC"],"summary":"Get User Roles","description":"Get all roles assigned to a user.","operationId":"get_user_roles_api_v1_rbac_users__user_id__roles_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRoleListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["rbac","RBAC"],"summary":"Assign Role To User","description":"Assign a role to a user.","operationId":"assign_role_to_user_api_v1_rbac_users__user_id__roles_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRoleAssignment"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRoleAssignmentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/users/{user_id}/roles/{role_id}":{"delete":{"tags":["rbac","RBAC"],"summary":"Revoke Role From User","description":"Revoke a role from a user.","operationId":"revoke_role_from_user_api_v1_rbac_users__user_id__roles__role_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}},{"name":"role_id","in":"path","required":true,"schema":{"type":"integer","title":"Role Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["rbac","RBAC"],"summary":"Replace User Role","description":"Atomically replace a user's role with a new role.\n\nThis ensures the single role policy by deactivating the old role\nand assigning the new role in a single transaction.","operationId":"replace_user_role_api_v1_rbac_users__user_id__roles__role_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}},{"name":"role_id","in":"path","required":true,"schema":{"type":"integer","title":"Role Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRoleAssignment"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRoleAssignmentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/users/bulk-assign-roles":{"post":{"tags":["rbac","RBAC"],"summary":"Bulk Assign Roles","description":"Assign a role to multiple users.","operationId":"bulk_assign_roles_api_v1_rbac_users_bulk_assign_roles_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkRoleAssignment"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkRoleAssignmentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/rbac/check-permission":{"post":{"tags":["rbac","RBAC"],"summary":"Check Permission","description":"Check if a user has a specific permission.","operationId":"check_permission_api_v1_rbac_check_permission_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionCheckRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionCheckResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/rbac/users/me/permissions":{"get":{"tags":["rbac","RBAC"],"summary":"Get Current User Permissions","description":"Get permissions for the current authenticated user.","operationId":"get_current_user_permissions_api_v1_rbac_users_me_permissions_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"type":"string"},"type":"array","title":"Response Get Current User Permissions Api V1 Rbac Users Me Permissions Get"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/rbac/users/{user_id}/permissions":{"get":{"tags":["rbac","RBAC"],"summary":"Get User Permissions Endpoint","description":"Get all permissions for a user.","operationId":"get_user_permissions_endpoint_api_v1_rbac_users__user_id__permissions_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"type":"string"},"title":"Response Get User Permissions Endpoint Api V1 Rbac Users  User Id  Permissions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/users/{user_id}/permission-summary":{"get":{"tags":["rbac","RBAC"],"summary":"Get User Permission Summary","description":"Get permission summary for a user.","operationId":"get_user_permission_summary_api_v1_rbac_users__user_id__permission_summary_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserPermissionSummary"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/system/permission-matrix":{"get":{"tags":["rbac","RBAC"],"summary":"Get System Permission Matrix","description":"Get system-wide permission matrix.","operationId":"get_system_permission_matrix_api_v1_rbac_system_permission_matrix_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SystemPermissionMatrix"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/rbac/resource-permissions":{"post":{"tags":["rbac","RBAC"],"summary":"Create Resource Permission","description":"Create a resource-level permission.","operationId":"create_resource_permission_api_v1_rbac_resource_permissions_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResourcePermissionCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResourcePermission"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/rbac/resource-permissions/{resource_type}/{resource_id}":{"get":{"tags":["rbac","RBAC"],"summary":"Get Resource Permissions","description":"Get all permissions for a specific resource.","operationId":"get_resource_permissions_api_v1_rbac_resource_permissions__resource_type___resource_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"resource_type","in":"path","required":true,"schema":{"type":"string","title":"Resource Type"}},{"name":"resource_id","in":"path","required":true,"schema":{"type":"integer","title":"Resource Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/matrix":{"get":{"tags":["rbac","RBAC"],"summary":"Get Permission Matrix","description":"Get the complete permission matrix showing role-permission mappings.","operationId":"get_permission_matrix_api_v1_rbac_matrix_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SystemPermissionMatrix"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/rbac/users/{user_id}/sync-role":{"post":{"tags":["rbac","RBAC"],"summary":"Sync User Role","description":"Synchronize a user's role field with their active role assignments.","operationId":"sync_user_role_api_v1_rbac_users__user_id__sync_role_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/sync-all-roles":{"post":{"tags":["rbac","RBAC"],"summary":"Sync All User Roles","description":"Synchronize all users' role fields with their active role assignments.","operationId":"sync_all_user_roles_api_v1_rbac_sync_all_roles_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/rbac/users/{user_id}/role-validation":{"get":{"tags":["rbac","RBAC"],"summary":"Validate User Role","description":"Validate that a user's role field matches their role assignments.","operationId":"validate_user_role_api_v1_rbac_users__user_id__role_validation_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rbac/health":{"get":{"tags":["rbac","RBAC"],"summary":"Rbac Health Check","description":"Check RBAC system health.","operationId":"rbac_health_check_api_v1_rbac_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/documents/":{"get":{"tags":["documents","Documents"],"summary":"List Documents","description":"List documents and folders with filtering and pagination.","operationId":"list_documents_api_v1_documents__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"parent_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Parent folder ID","title":"Parent Id"},"description":"Parent folder ID"},{"name":"document_type","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/DocumentType"},{"type":"null"}],"description":"Document type filter","title":"Document Type"},"description":"Document type filter"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/DocumentStatus"},{"type":"null"}],"description":"Document status","default":"active","title":"Status"},"description":"Document status"},{"name":"tags","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by tags (comma-separated)","title":"Tags"},"description":"Filter by tags (comma-separated)"},{"name":"search","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search in document names and descriptions","title":"Search"},"description":"Search in document names and descriptions"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Page size","default":20,"title":"Size"},"description":"Page size"},{"name":"sort_by","in":"query","required":false,"schema":{"type":"string","description":"Sort field","default":"updated_at","title":"Sort By"},"description":"Sort field"},{"name":"sort_order","in":"query","required":false,"schema":{"type":"string","description":"Sort order","default":"desc","title":"Sort Order"},"description":"Sort order"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentList"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["documents","Documents"],"summary":"Create Document","description":"Create a new document or folder.","operationId":"create_document_api_v1_documents__post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Document"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/statistics":{"get":{"tags":["documents","Documents"],"summary":"Get Document Statistics","description":"Get document statistics for the current user.","operationId":"get_document_statistics_api_v1_documents_statistics_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentStatistics"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/trash":{"get":{"tags":["documents","Documents"],"summary":"List Trash Items","description":"List all documents in trash for the current user (all hierarchy levels).","operationId":"list_trash_items_api_v1_documents_trash_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Page size","default":20,"title":"Size"},"description":"Page size"},{"name":"sort_by","in":"query","required":false,"schema":{"type":"string","description":"Sort field","default":"updated_at","title":"Sort By"},"description":"Sort field"},{"name":"sort_order","in":"query","required":false,"schema":{"type":"string","description":"Sort order","default":"desc","title":"Sort Order"},"description":"Sort order"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentList"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/{document_id}":{"get":{"tags":["documents","Documents"],"summary":"Get Document","description":"Get a specific document by ID.","operationId":"get_document_api_v1_documents__document_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Document"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["documents","Documents"],"summary":"Update Document","description":"Update an existing document.","operationId":"update_document_api_v1_documents__document_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Document"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["documents","Documents"],"summary":"Delete Document","description":"Delete or archive a document.","operationId":"delete_document_api_v1_documents__document_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}},{"name":"permanent","in":"query","required":false,"schema":{"type":"boolean","description":"Permanently delete (vs archive)","default":false,"title":"Permanent"},"description":"Permanently delete (vs archive)"}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/upload":{"post":{"tags":["documents","Documents"],"summary":"Upload File","description":"Upload an encrypted file with metadata (Unicode-safe).","operationId":"upload_file_api_v1_documents_upload_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_file_api_v1_documents_upload_post"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Document"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/{document_id}/download":{"get":{"tags":["documents","Documents"],"summary":"Download File","description":"Download an encrypted file.","operationId":"download_file_api_v1_documents__document_id__download_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/{document_id}/download/decrypted":{"post":{"tags":["documents","Documents"],"summary":"Download Decrypted File","description":"Download a decrypted file with password authentication.","operationId":"download_decrypted_file_api_v1_documents__document_id__download_decrypted_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DecryptDownloadRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/search":{"post":{"tags":["documents","Documents"],"summary":"Search Documents","description":"Enhanced search documents with advanced filtering and full-text capabilities.","operationId":"search_documents_api_v1_documents_search_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentSearch"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentList"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/search/suggestions/tags":{"get":{"tags":["documents","Documents"],"summary":"Get Tag Suggestions","description":"Get tag suggestions based on existing tags.","operationId":"get_tag_suggestions_api_v1_documents_search_suggestions_tags_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"query","in":"query","required":false,"schema":{"type":"string","description":"Tag search query","default":"","title":"Query"},"description":"Tag search query"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":50,"minimum":1,"description":"Maximum number of suggestions","default":10,"title":"Limit"},"description":"Maximum number of suggestions"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"type":"string"},"title":"Response Get Tag Suggestions Api V1 Documents Search Suggestions Tags Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/search/suggestions/authors":{"get":{"tags":["documents","Documents"],"summary":"Get Author Suggestions","description":"Get author suggestions (admin only).","operationId":"get_author_suggestions_api_v1_documents_search_suggestions_authors_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"query","in":"query","required":false,"schema":{"type":"string","description":"Author search query","default":"","title":"Query"},"description":"Author search query"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":50,"minimum":1,"description":"Maximum number of suggestions","default":10,"title":"Limit"},"description":"Maximum number of suggestions"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"type":"object"},"title":"Response Get Author Suggestions Api V1 Documents Search Suggestions Authors Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/search/file-categories":{"get":{"tags":["documents","Documents"],"summary":"Get File Categories","description":"Get available file categories with counts.","operationId":"get_file_categories_api_v1_documents_search_file_categories_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"type":"object"},"type":"array","title":"Response Get File Categories Api V1 Documents Search File Categories Get"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/{document_id}/permissions":{"get":{"tags":["documents","Documents"],"summary":"Get Document Permissions","description":"Get all permissions for a document.","operationId":"get_document_permissions_api_v1_documents__document_id__permissions_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DocumentPermission"},"title":"Response Get Document Permissions Api V1 Documents  Document Id  Permissions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["documents","Documents"],"summary":"Create Document Permission","description":"Grant permission to a user for a document.","operationId":"create_document_permission_api_v1_documents__document_id__permissions_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentPermissionCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentPermission"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/bulk-operation":{"post":{"tags":["documents","Documents"],"summary":"Bulk Document Operation","description":"Perform bulk operations on documents.","operationId":"bulk_document_operation_api_v1_documents_bulk_operation_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkDocumentOperation"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkDocumentResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/folders/tree":{"get":{"tags":["documents","Documents"],"summary":"Get Folder Tree","description":"Get hierarchical folder tree structure.","operationId":"get_folder_tree_api_v1_documents_folders_tree_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"root_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Root folder ID (null for top level)","title":"Root Id"},"description":"Root folder ID (null for top level)"},{"name":"max_depth","in":"query","required":false,"schema":{"type":"integer","maximum":20,"minimum":1,"description":"Maximum tree depth","default":10,"title":"Max Depth"},"description":"Maximum tree depth"},{"name":"include_documents","in":"query","required":false,"schema":{"type":"boolean","description":"Include documents in tree","default":false,"title":"Include Documents"},"description":"Include documents in tree"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DocumentTree"},"title":"Response Get Folder Tree Api V1 Documents Folders Tree Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/folders/{folder_id}/path":{"get":{"tags":["documents","Documents"],"summary":"Get Folder Path","description":"Get the full path of a folder (breadcrumb trail).","operationId":"get_folder_path_api_v1_documents_folders__folder_id__path_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"folder_id","in":"path","required":true,"schema":{"type":"integer","title":"Folder Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/folders/bulk-move":{"post":{"tags":["documents","Documents"],"summary":"Bulk Move Folders","description":"Move multiple folders to a new parent folder.","operationId":"bulk_move_folders_api_v1_documents_folders_bulk_move_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentMoveRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/folders/{folder_id}/copy":{"post":{"tags":["documents","Documents"],"summary":"Copy Folder Hierarchy","description":"Copy a folder and its entire hierarchy to a new location.","operationId":"copy_folder_hierarchy_api_v1_documents_folders__folder_id__copy_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"folder_id","in":"path","required":true,"schema":{"type":"integer","title":"Folder Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentCopyRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/folders/{folder_id}/permissions/inherit":{"post":{"tags":["documents","Documents"],"summary":"Apply Permission Inheritance","description":"Apply permission inheritance to a folder hierarchy.","operationId":"apply_permission_inheritance_api_v1_documents_folders__folder_id__permissions_inherit_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"folder_id","in":"path","required":true,"schema":{"type":"integer","title":"Folder Id"}},{"name":"recursive","in":"query","required":false,"schema":{"type":"boolean","description":"Apply to all subfolders","default":true,"title":"Recursive"},"description":"Apply to all subfolders"},{"name":"overwrite_existing","in":"query","required":false,"schema":{"type":"boolean","description":"Overwrite existing permissions","default":false,"title":"Overwrite Existing"},"description":"Overwrite existing permissions"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/bulk-create-folders":{"post":{"tags":["documents","Documents"],"summary":"Bulk Create Folders","description":"Create multiple folders in a single transaction.","operationId":"bulk_create_folders_api_v1_documents_bulk_create_folders_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkFolderCreateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkFolderCreateResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/batch-upload-files":{"post":{"tags":["documents","Documents"],"summary":"Batch Upload Files","description":"Upload multiple files with folder structure in a single batch.","operationId":"batch_upload_files_api_v1_documents_batch_upload_files_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_batch_upload_files_api_v1_documents_batch_upload_files_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchFileUploadResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/health":{"get":{"tags":["documents","Documents"],"summary":"Documents Health Check","description":"Check document system health.","operationId":"documents_health_check_api_v1_documents_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/documents/trash/empty":{"post":{"tags":["documents","Documents"],"summary":"Empty Trash","description":"Permanently delete all documents in trash for the current user.","operationId":"empty_trash_api_v1_documents_trash_empty_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/trash/recover-all":{"post":{"tags":["documents","Documents"],"summary":"Recover All From Trash","description":"Recover all documents from trash for the current user.","operationId":"recover_all_from_trash_api_v1_documents_trash_recover_all_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/documents/{document_id}/recover":{"post":{"tags":["documents","Documents"],"summary":"Recover Document","description":"Recover a single document from trash.","operationId":"recover_document_api_v1_documents__document_id__recover_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/{document_id}/permanent":{"delete":{"tags":["documents","Documents"],"summary":"Permanently Delete Document","description":"Permanently delete a document from trash.","operationId":"permanently_delete_document_api_v1_documents__document_id__permanent_delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/encryption/keys":{"post":{"tags":["encryption","Encryption"],"summary":"Create Encryption Key","description":"Create a new user encryption key.","operationId":"create_encryption_key_api_v1_encryption_keys_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EncryptionKeyCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EncryptionKeyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["encryption","Encryption"],"summary":"List User Encryption Keys","description":"List user's encryption keys.","operationId":"list_user_encryption_keys_api_v1_encryption_keys_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"include_inactive","in":"query","required":false,"schema":{"type":"boolean","description":"Include inactive keys","default":false,"title":"Include Inactive"},"description":"Include inactive keys"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EncryptionKeyList"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/encryption/keys/all":{"get":{"tags":["encryption","Encryption"],"summary":"List All Encryption Keys","description":"List all encryption keys (admin only) or user's keys.","operationId":"list_all_encryption_keys_api_v1_encryption_keys_all_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"include_inactive","in":"query","required":false,"schema":{"type":"boolean","description":"Include inactive keys","default":false,"title":"Include Inactive"},"description":"Include inactive keys"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EncryptionKeyList"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/encryption/keys/{key_id}":{"get":{"tags":["encryption","Encryption"],"summary":"Get Encryption Key","description":"Get a specific encryption key.","operationId":"get_encryption_key_api_v1_encryption_keys__key_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"key_id","in":"path","required":true,"schema":{"type":"string","title":"Key Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EncryptionKeyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["encryption","Encryption"],"summary":"Deactivate Encryption Key","description":"Deactivate an encryption key.","operationId":"deactivate_encryption_key_api_v1_encryption_keys__key_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"key_id","in":"path","required":true,"schema":{"type":"string","title":"Key Id"}},{"name":"reason","in":"query","required":false,"schema":{"type":"string","description":"Reason for deactivation","default":"User requested deactivation","title":"Reason"},"description":"Reason for deactivation"}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/encryption/keys/{key_id}/rotate":{"post":{"tags":["encryption","Encryption"],"summary":"Rotate Encryption Key","description":"Rotate an existing encryption key by creating a new one and deactivating the old one.","operationId":"rotate_encryption_key_api_v1_encryption_keys__key_id__rotate_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"key_id","in":"path","required":true,"schema":{"type":"string","title":"Key Id"}},{"name":"force_rotation","in":"query","required":false,"schema":{"type":"boolean","description":"Force rotation even if key is not expired","default":false,"title":"Force Rotation"},"description":"Force rotation even if key is not expired"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EncryptionKeyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/encryption/derive-key":{"post":{"tags":["encryption","Encryption"],"summary":"Derive Encryption Key","description":"Derive encryption key using PBKDF2 with provided parameters.","operationId":"derive_encryption_key_api_v1_encryption_derive_key_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/app__schemas__encryption__KeyDerivationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KeyDerivationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/encryption/validate":{"post":{"tags":["encryption","Encryption"],"summary":"Validate Encryption","description":"Validate encryption/decryption with provided parameters.","operationId":"validate_encryption_api_v1_encryption_validate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EncryptionValidationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EncryptionValidationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/encryption/parameters":{"get":{"tags":["encryption","Encryption"],"summary":"Get Crypto Parameters","description":"Get recommended cryptographic parameters.","operationId":"get_crypto_parameters_api_v1_encryption_parameters_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CryptoParameters"}}}}}}},"/api/v1/encryption/generate-salt":{"post":{"tags":["encryption","Encryption"],"summary":"Generate Salt","description":"Generate a cryptographically secure random salt.","operationId":"generate_salt_api_v1_encryption_generate_salt_post","parameters":[{"name":"length","in":"query","required":false,"schema":{"type":"integer","maximum":64,"minimum":16,"description":"Salt length in bytes","default":32,"title":"Length"},"description":"Salt length in bytes"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/encryption/generate-iv":{"post":{"tags":["encryption","Encryption"],"summary":"Generate Iv","description":"Generate a cryptographically secure random IV for AES-GCM.","operationId":"generate_iv_api_v1_encryption_generate_iv_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/encryption/escrow":{"post":{"tags":["encryption","Encryption"],"summary":"Create Key Escrow","description":"Create key escrow (admin only).","operationId":"create_key_escrow_api_v1_encryption_escrow_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KeyEscrowCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KeyEscrowResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/encryption/recover":{"post":{"tags":["encryption","Encryption"],"summary":"Recover Encryption Key","description":"Recover encryption key from escrow (admin only).","operationId":"recover_encryption_key_api_v1_encryption_recover_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KeyRecoveryRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KeyRecoveryResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/encryption/health":{"get":{"tags":["encryption","Encryption"],"summary":"Encryption Health Check","description":"Check encryption system health.","operationId":"encryption_health_check_api_v1_encryption_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EncryptionHealthCheck"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/admin/users":{"get":{"tags":["admin","Admin"],"summary":"List Users","description":"List all users with filtering and pagination.","operationId":"list_users_api_v1_admin_users_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Page size","default":20,"title":"Size"},"description":"Page size"},{"name":"search","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search by username or email","title":"Search"},"description":"Search by username or email"},{"name":"is_active","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"description":"Filter by active status","title":"Is Active"},"description":"Filter by active status"},{"name":"role","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by role","title":"Role"},"description":"Filter by role"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["admin","Admin"],"summary":"Create User","description":"Create a new user account.","operationId":"create_user_api_v1_admin_users_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/admin/users/{user_id}":{"put":{"tags":["admin","Admin"],"summary":"Update User","description":"Update an existing user account.","operationId":"update_user_api_v1_admin_users__user_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["admin","Admin"],"summary":"Delete User","description":"Delete a user account (hard delete - permanently removes from database).","operationId":"delete_user_api_v1_admin_users__user_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/admin/users/{user_id}/reset-password":{"post":{"tags":["admin","Admin"],"summary":"Reset User Password","description":"Reset a user's password.","operationId":"reset_user_password_api_v1_admin_users__user_id__reset_password_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordResetRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/admin/users/bulk-operation":{"post":{"tags":["admin","Admin"],"summary":"Bulk User Operation","description":"Perform bulk operations on multiple users.","operationId":"bulk_user_operation_api_v1_admin_users_bulk_operation_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkUserOperation"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/admin/system/health":{"get":{"tags":["admin","Admin"],"summary":"Get System Health","description":"Get comprehensive system health status.","operationId":"get_system_health_api_v1_admin_system_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SystemHealthResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/admin/system/metrics":{"get":{"tags":["admin","Admin"],"summary":"Get System Metrics","description":"Get system performance metrics.","operationId":"get_system_metrics_api_v1_admin_system_metrics_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"hours","in":"query","required":false,"schema":{"type":"integer","maximum":168,"minimum":1,"description":"Hours of historical data","default":24,"title":"Hours"},"description":"Hours of historical data"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SystemMetricsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/admin/audit/logs":{"get":{"tags":["admin","Admin"],"summary":"Get Audit Logs","description":"Get audit logs with filtering and pagination.","operationId":"get_audit_logs_api_v1_admin_audit_logs_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"size","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"description":"Page size","default":50,"title":"Size"},"description":"Page size"},{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Filter by user ID","title":"User Id"},"description":"Filter by user ID"},{"name":"action","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by action type","title":"Action"},"description":"Filter by action type"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Start date filter","title":"Start Date"},"description":"Start date filter"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"End date filter","title":"End Date"},"description":"End date filter"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuditLogListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/admin/audit/compliance-report":{"get":{"tags":["admin","Admin"],"summary":"Generate Compliance Report","description":"Generate compliance report for specified date range.","operationId":"generate_compliance_report_api_v1_admin_audit_compliance_report_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"report_type","in":"query","required":false,"schema":{"type":"string","description":"Type of compliance report","default":"activity","title":"Report Type"},"description":"Type of compliance report"},{"name":"start_date","in":"query","required":true,"schema":{"type":"string","description":"Report start date (YYYY-MM-DD)","title":"Start Date"},"description":"Report start date (YYYY-MM-DD)"},{"name":"end_date","in":"query","required":true,"schema":{"type":"string","description":"Report end date (YYYY-MM-DD)","title":"End Date"},"description":"Report end date (YYYY-MM-DD)"},{"name":"format","in":"query","required":false,"schema":{"type":"string","description":"Report format (json, csv)","default":"json","title":"Format"},"description":"Report format (json, csv)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/admin/users/{user_id}/activity":{"get":{"tags":["admin","Admin"],"summary":"Get User Activity","description":"Get detailed activity for a specific user.","operationId":"get_user_activity_api_v1_admin_users__user_id__activity_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}},{"name":"days","in":"query","required":false,"schema":{"type":"integer","maximum":365,"minimum":1,"description":"Days of activity to retrieve","default":30,"title":"Days"},"description":"Days of activity to retrieve"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserActivityResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/security/events":{"get":{"tags":["security","Security"],"summary":"Get Security Events","description":"Get security events with filtering and pagination.","operationId":"get_security_events_api_v1_security_events_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"size","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"description":"Page size","default":50,"title":"Size"},"description":"Page size"},{"name":"threat_level","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/ThreatLevel"},{"type":"null"}],"description":"Filter by threat level","title":"Threat Level"},"description":"Filter by threat level"},{"name":"event_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by event type","title":"Event Type"},"description":"Filter by event type"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/EventStatus"},{"type":"null"}],"description":"Filter by status","title":"Status"},"description":"Filter by status"},{"name":"source_ip","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by source IP","title":"Source Ip"},"description":"Filter by source IP"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Start date filter","title":"Start Date"},"description":"Start date filter"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"End date filter","title":"End Date"},"description":"End date filter"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SecurityEventListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/security/events/{event_id}":{"get":{"tags":["security","Security"],"summary":"Get Security Event","description":"Get a specific security event by ID.","operationId":"get_security_event_api_v1_security_events__event_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"event_id","in":"path","required":true,"schema":{"type":"string","title":"Event Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SecurityEventResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["security","Security"],"summary":"Update Security Event","description":"Update a security event (e.g., change status, add resolution notes).","operationId":"update_security_event_api_v1_security_events__event_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"event_id","in":"path","required":true,"schema":{"type":"string","title":"Event Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateSecurityEventRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SecurityEventResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/security/events/analyze":{"post":{"tags":["security","Security"],"summary":"Analyze Security Event","description":"Analyze a potential security event.","operationId":"analyze_security_event_api_v1_security_events_analyze_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateSecurityEventRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/security/dashboard":{"get":{"tags":["security","Security"],"summary":"Get Security Dashboard","description":"FIXED: Get comprehensive security dashboard with sessions and audit logs.","operationId":"get_security_dashboard_api_v1_security_dashboard_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"hours","in":"query","required":false,"schema":{"type":"integer","maximum":168,"minimum":1,"description":"Hours of data to include","default":24,"title":"Hours"},"description":"Hours of data to include"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SecurityDashboardResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/security/blocklist":{"get":{"tags":["security","Security"],"summary":"Get Ip Blocklist","description":"Get IP blocklist.","operationId":"get_ip_blocklist_api_v1_security_blocklist_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"active_only","in":"query","required":false,"schema":{"type":"boolean","description":"Show only active blocks","default":true,"title":"Active Only"},"description":"Show only active blocks"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/IPBlocklistResponse"},"title":"Response Get Ip Blocklist Api V1 Security Blocklist Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["security","Security"],"summary":"Block Ip Address","description":"Manually block an IP address.","operationId":"block_ip_address_api_v1_security_blocklist_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IPBlockRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IPBlocklistResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/security/blocklist/{ip_address}":{"delete":{"tags":["security","Security"],"summary":"Unblock Ip Address","description":"Manually unblock an IP address.","operationId":"unblock_ip_address_api_v1_security_blocklist__ip_address__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"ip_address","in":"path","required":true,"schema":{"type":"string","title":"Ip Address"}},{"name":"reason","in":"query","required":true,"schema":{"type":"string","description":"Reason for unblocking","title":"Reason"},"description":"Reason for unblocking"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/security/metrics":{"get":{"tags":["security","Security"],"summary":"Get Security Metrics","description":"Get security metrics and statistics.","operationId":"get_security_metrics_api_v1_security_metrics_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"days","in":"query","required":false,"schema":{"type":"integer","maximum":90,"minimum":1,"description":"Days of metrics to retrieve","default":7,"title":"Days"},"description":"Days of metrics to retrieve"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SecurityMetricsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/security/tasks/correlate-events":{"post":{"tags":["security","Security"],"summary":"Trigger Event Correlation","description":"Trigger manual event correlation.","operationId":"trigger_event_correlation_api_v1_security_tasks_correlate_events_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/security/tasks/cleanup-blocks":{"post":{"tags":["security","Security"],"summary":"Trigger Block Cleanup","description":"Trigger cleanup of expired IP blocks.","operationId":"trigger_block_cleanup_api_v1_security_tasks_cleanup_blocks_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/security-headers/csp-violations":{"post":{"tags":["security-headers","Security Headers"],"summary":"Report Csp Violation","description":"Report a Content Security Policy violation.","operationId":"report_csp_violation_api_v1_security_headers_csp_violations_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CSPViolationReportRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["security-headers","Security Headers"],"summary":"Get Csp Violations","description":"Get recent CSP violations - no authentication required for monitoring.","operationId":"get_csp_violations_api_v1_security_headers_csp_violations_get","parameters":[{"name":"hours","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Hours"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/security-headers/validate-headers":{"post":{"tags":["security-headers","Security Headers"],"summary":"Validate Security Headers","description":"Validate security headers for a given URL and set of headers.","operationId":"validate_security_headers_api_v1_security_headers_validate_headers_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SecurityHeadersCheck"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SecurityHeadersResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/security-headers/csp-violations/stats":{"get":{"tags":["security-headers","Security Headers"],"summary":"Get Csp Violation Stats","description":"Get CSP violation statistics.","operationId":"get_csp_violation_stats_api_v1_security_headers_csp_violations_stats_get","parameters":[{"name":"days","in":"query","required":false,"schema":{"type":"integer","default":7,"title":"Days"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/public/csp-violations":{"get":{"tags":["public-security-headers","Public Security Headers"],"summary":"Get Csp Violations Public","description":"Get recent CSP violations - completely public endpoint.","operationId":"get_csp_violations_public_api_public_csp_violations_get","parameters":[{"name":"hours","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Hours"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/templates/":{"get":{"tags":["templates"],"summary":"List Templates","description":"List all available project templates\n\nReturns both system templates and user's custom templates.\nCan be filtered by category.","operationId":"list_templates_api_v1_templates__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"category","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/TemplateCategory"},{"type":"null"}],"description":"Filter by category","title":"Category"},"description":"Filter by category"},{"name":"include_custom","in":"query","required":false,"schema":{"type":"boolean","description":"Include user's custom templates","default":true,"title":"Include Custom"},"description":"Include user's custom templates"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TemplateListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["templates"],"summary":"Create Template","description":"Create a new custom template\n\nAllows users with appropriate permissions to create custom templates.\nSystem templates cannot be created through this endpoint.","operationId":"create_template_api_v1_templates__post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TemplateCreateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectTemplate"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/templates/{template_id}":{"get":{"tags":["templates"],"summary":"Get Template","description":"Get a specific template by ID\n\nReturns the complete template definition including structure.","operationId":"get_template_api_v1_templates__template_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"template_id","in":"path","required":true,"schema":{"type":"string","title":"Template Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectTemplate"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["templates"],"summary":"Update Template","description":"Update an existing custom template\n\nOnly custom templates can be updated. System templates are read-only.\nUsers can only update their own templates unless they are admins.","operationId":"update_template_api_v1_templates__template_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"template_id","in":"path","required":true,"schema":{"type":"string","title":"Template Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TemplateUpdateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectTemplate"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["templates"],"summary":"Delete Template","description":"Delete a custom template\n\nOnly custom templates can be deleted. System templates cannot be deleted.\nUsers can only delete their own templates unless they are admins.","operationId":"delete_template_api_v1_templates__template_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"template_id","in":"path","required":true,"schema":{"type":"string","title":"Template Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/templates/{template_id}/preview":{"post":{"tags":["templates"],"summary":"Preview Template","description":"Preview what a template will create\n\nShows the resolved folder structure with variable substitutions\nwithout actually creating anything.","operationId":"preview_template_api_v1_templates__template_id__preview_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"template_id","in":"path","required":true,"schema":{"type":"string","title":"Template Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TemplateVariables"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TemplatePreview"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/templates/{template_id}/apply":{"post":{"tags":["templates"],"summary":"Apply Template","description":"Apply a template to create folder structure\n\nCreates the complete folder hierarchy defined in the template\nwith variable substitutions and optional permissions/tags.","operationId":"apply_template_api_v1_templates__template_id__apply_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"template_id","in":"path","required":true,"schema":{"type":"string","title":"Template Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TemplateApplicationRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TemplateApplicationResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/templates/categories/":{"get":{"tags":["templates"],"summary":"Get Template Categories","description":"Get all available template categories\n\nReturns a list of all template categories for filtering purposes.","operationId":"get_template_categories_api_v1_templates_categories__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"type":"string"},"type":"array","title":"Response Get Template Categories Api V1 Templates Categories  Get"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/templates/{template_id}/usage-stats":{"get":{"tags":["templates"],"summary":"Get Template Usage Stats","description":"Get usage statistics for a template\n\nReturns usage count, last used date, and other statistics.\nOnly available to admins and template creators.","operationId":"get_template_usage_stats_api_v1_templates__template_id__usage_stats_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"template_id","in":"path","required":true,"schema":{"type":"string","title":"Template Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/{document_id}/preview":{"get":{"tags":["document-preview","document-preview"],"summary":"Get Document Preview","description":"Generate and return document preview based on file type\n\nPreview Types:\n- thumbnail: Image thumbnail or first page for PDFs\n- text: Text extraction preview (first 500 chars)\n- metadata: File metadata and basic info\n- auto: Automatically choose best preview type","operationId":"get_document_preview_api_v1_documents__document_id__preview_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}},{"name":"preview_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Preview type: thumbnail, text, metadata, auto","default":"auto","title":"Preview Type"},"description":"Preview type: thumbnail, text, metadata, auto"},{"name":"max_size","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Maximum preview size in pixels for images","default":1024,"title":"Max Size"},"description":"Maximum preview size in pixels for images"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/{document_id}/preview/encrypted":{"post":{"tags":["document-preview","document-preview"],"summary":"Get Encrypted Document Preview","description":"Generate preview for encrypted document with provided password","operationId":"get_encrypted_document_preview_api_v1_documents__document_id__preview_encrypted_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}},{"name":"preview_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":"auto","title":"Preview Type"}},{"name":"max_size","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":1024,"title":"Max Size"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/{document_id}/preview/encrypted/test":{"post":{"tags":["document-preview","document-preview"],"summary":"Test Encrypted Preview","description":"Test endpoint without authentication for debugging 422 errors","operationId":"test_encrypted_preview_api_v1_documents__document_id__preview_encrypted_test_post","parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}},{"name":"preview_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":"auto","title":"Preview Type"}},{"name":"max_size","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":1024,"title":"Max Size"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/{document_id}/preview/encrypted/debug":{"post":{"tags":["document-preview","document-preview"],"summary":"Debug Encrypted Preview","description":"Debug endpoint without any dependencies to test 422 validation","operationId":"debug_encrypted_preview_api_v1_documents__document_id__preview_encrypted_debug_post","parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}},{"name":"preview_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":"auto","title":"Preview Type"}},{"name":"max_size","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":1024,"title":"Max Size"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/test":{"get":{"tags":["document-preview","document-preview"],"summary":"Test Endpoint","description":"Simple test endpoint to verify server is working with our changes","operationId":"test_endpoint_api_v1_documents_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/documents/simple/{document_id}/preview":{"post":{"tags":["document-preview","document-preview"],"summary":"Simple Preview Test","description":"Simple preview test without complex error handling","operationId":"simple_preview_test_api_v1_documents_simple__document_id__preview_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/documents/{document_id}/preview/formats":{"get":{"tags":["document-preview","document-preview"],"summary":"Get Supported Preview Formats","description":"Get supported preview formats for a document","operationId":"get_supported_preview_formats_api_v1_documents__document_id__preview_formats_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/monitoring/system":{"get":{"tags":["monitoring","Monitoring"],"summary":"Get System Metrics","description":"Get real-time system metrics.","operationId":"get_system_metrics_api_v1_monitoring_system_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/monitoring/user-activity":{"get":{"tags":["monitoring","Monitoring"],"summary":"Get User Activity","description":"Get user activity logs with suspicious behavior detection.","operationId":"get_user_activity_api_v1_monitoring_user_activity_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"hours","in":"query","required":false,"schema":{"type":"integer","maximum":168,"minimum":1,"default":24,"title":"Hours"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":1000,"minimum":1,"default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/monitoring/alerts":{"get":{"tags":["monitoring","Monitoring"],"summary":"Get Security Alerts","description":"Get security alerts with real-time threat detection.","operationId":"get_security_alerts_api_v1_monitoring_alerts_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"severity","in":"query","required":false,"schema":{"type":"string","pattern":"^(all|low|medium|high|critical)$","default":"all","title":"Severity"}},{"name":"hours","in":"query","required":false,"schema":{"type":"integer","maximum":168,"minimum":1,"default":24,"title":"Hours"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/keys/derive":{"post":{"tags":["key-management","Key Management"],"summary":"Derive Key","description":"FIXED: Derive keys without storing plaintext.","operationId":"derive_key_api_v1_keys_derive_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/app__api__v1__key_management__KeyDerivationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/keys/rotate":{"post":{"tags":["key-management","Key Management"],"summary":"Rotate Keys","description":"FIXED: Rotate keys without exposing plaintext.","operationId":"rotate_keys_api_v1_keys_rotate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KeyRotationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/keys/status":{"get":{"tags":["key-management","Key Management"],"summary":"Get Key Status","description":"FIXED: Get key status without exposing sensitive data.","operationId":"get_key_status_api_v1_keys_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/keys/hierarchy":{"get":{"tags":["key-management","Key Management"],"summary":"Get Key Hierarchy","description":"FIXED: Get key hierarchy information (no sensitive data).","operationId":"get_key_hierarchy_api_v1_keys_hierarchy_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/public/csp-violations":{"get":{"summary":"Get Csp Violations Public","description":"Get recent CSP violations - completely public endpoint.","operationId":"get_csp_violations_public_public_csp_violations_get","parameters":[{"name":"hours","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Hours"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint providing API information.","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health Check","description":"Health check endpoint for container monitoring.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/cors-test":{"get":{"summary":"Cors Test","description":"CORS test endpoint to verify CORS configuration.","operationId":"cors_test_cors_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health/db":{"get":{"summary":"Database Health","description":"Database health check endpoint.","operationId":"database_health_health_db_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health/redis":{"get":{"summary":"Redis Health","description":"Redis health check endpoint.","operationId":"redis_health_health_redis_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AuditLogListResponse":{"properties":{"logs":{"items":{"$ref":"#/components/schemas/AuditLogResponse"},"type":"array","title":"Logs","description":"List of audit logs"},"total":{"type":"integer","title":"Total","description":"Total number of logs"},"page":{"type":"integer","title":"Page","description":"Current page number"},"size":{"type":"integer","title":"Size","description":"Page size"},"has_next":{"type":"boolean","title":"Has Next","description":"Whether there are more pages"}},"type":"object","required":["logs","total","page","size","has_next"],"title":"AuditLogListResponse","description":"Schema for paginated audit log list response."},"AuditLogResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Log entry ID"},"document_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Document Id","description":"Document ID"},"user_id":{"type":"integer","title":"User Id","description":"User ID"},"action":{"type":"string","title":"Action","description":"Action performed"},"access_method":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Method","description":"Access method"},"success":{"type":"boolean","title":"Success","description":"Whether action was successful"},"accessed_at":{"type":"string","format":"date-time","title":"Accessed At","description":"Access timestamp"},"ip_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ip Address","description":"IP address"},"user_agent":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Agent","description":"User agent"},"details":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Details","description":"Additional details"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message","description":"Error message if failed"}},"type":"object","required":["id","user_id","action","success","accessed_at"],"title":"AuditLogResponse","description":"Schema for audit log response."},"BackupCodesRequest":{"properties":{"password":{"type":"string","title":"Password","description":"User's current password for verification"},"count":{"anyOf":[{"type":"integer","maximum":20.0,"minimum":5.0},{"type":"null"}],"title":"Count","description":"Number of backup codes to generate","default":10}},"type":"object","required":["password"],"title":"BackupCodesRequest","description":"Request schema for generating new backup codes."},"BackupCodesResponse":{"properties":{"backup_codes":{"items":{"type":"string"},"type":"array","title":"Backup Codes","description":"New backup codes"},"codes_replaced":{"type":"integer","title":"Codes Replaced","description":"Number of old codes that were replaced","default":0}},"type":"object","required":["backup_codes"],"title":"BackupCodesResponse","description":"Response schema for backup codes generation."},"BatchFileUploadResult":{"properties":{"successful":{"items":{"type":"object"},"type":"array","title":"Successful","description":"Successfully uploaded files"},"failed":{"items":{"type":"object"},"type":"array","title":"Failed","description":"Failed file uploads with reasons"},"total_requested":{"type":"integer","title":"Total Requested","description":"Total number of files requested"},"total_uploaded":{"type":"integer","title":"Total Uploaded","description":"Total number of files uploaded"},"folders_created":{"items":{"type":"object"},"type":"array","title":"Folders Created","description":"Folders created during upload"},"total_size":{"type":"integer","title":"Total Size","description":"Total size of uploaded files in bytes","default":0}},"type":"object","required":["successful","failed","total_requested","total_uploaded"],"title":"BatchFileUploadResult","description":"Schema for batch file upload result."},"Body_batch_upload_files_api_v1_documents_batch_upload_files_post":{"properties":{"files":{"items":{"type":"string","format":"binary"},"type":"array","title":"Files"},"metadata":{"type":"string","title":"Metadata"}},"type":"object","required":["files","metadata"],"title":"Body_batch_upload_files_api_v1_documents_batch_upload_files_post"},"Body_upload_file_api_v1_documents_upload_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"upload_data":{"type":"string","title":"Upload Data","description":"JSON document upload metadata"}},"type":"object","required":["file","upload_data"],"title":"Body_upload_file_api_v1_documents_upload_post"},"BulkDocumentOperation":{"properties":{"document_ids":{"items":{"type":"integer"},"type":"array","minItems":1,"title":"Document Ids","description":"List of document IDs"},"operation":{"type":"string","title":"Operation","description":"Operation to perform"},"parameters":{"type":"object","title":"Parameters","description":"Operation parameters"}},"type":"object","required":["document_ids","operation"],"title":"BulkDocumentOperation","description":"Schema for bulk document operations."},"BulkDocumentResult":{"properties":{"successful":{"items":{"type":"integer"},"type":"array","title":"Successful","description":"Successfully processed document IDs"},"failed":{"items":{"type":"object"},"type":"array","title":"Failed","description":"Failed operations with reasons"},"total_processed":{"type":"integer","title":"Total Processed","description":"Total number of documents processed"}},"type":"object","required":["successful","failed","total_processed"],"title":"BulkDocumentResult","description":"Schema for bulk operation results."},"BulkFolderCreateRequest":{"properties":{"parent_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Parent Id","description":"Parent folder ID"},"folders":{"items":{"$ref":"#/components/schemas/FolderCreationItem"},"type":"array","minItems":1,"title":"Folders","description":"Folders to create"},"conflict_resolution":{"type":"string","title":"Conflict Resolution","description":"How to handle existing folders","default":"skip"}},"type":"object","required":["folders"],"title":"BulkFolderCreateRequest","description":"Schema for bulk folder creation request."},"BulkFolderCreateResult":{"properties":{"successful":{"items":{"type":"object"},"type":"array","title":"Successful","description":"Successfully created folders"},"failed":{"items":{"type":"object"},"type":"array","title":"Failed","description":"Failed folder creations with reasons"},"total_requested":{"type":"integer","title":"Total Requested","description":"Total number of folders requested"},"total_created":{"type":"integer","title":"Total Created","description":"Total number of folders created"},"skipped":{"items":{"type":"object"},"type":"array","title":"Skipped","description":"Skipped folders"}},"type":"object","required":["successful","failed","total_requested","total_created"],"title":"BulkFolderCreateResult","description":"Schema for bulk folder creation result."},"BulkRoleAssignment":{"properties":{"user_ids":{"items":{"type":"integer"},"type":"array","minItems":1,"title":"User Ids","description":"List of user IDs"},"role_name":{"type":"string","title":"Role Name","description":"Role name to assign"},"is_primary":{"type":"boolean","title":"Is Primary","description":"Whether to set as primary role","default":false},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"When assignments expire"}},"type":"object","required":["user_ids","role_name"],"title":"BulkRoleAssignment","description":"Schema for bulk role assignments."},"BulkRoleAssignmentResponse":{"properties":{"successful":{"items":{"type":"integer"},"type":"array","title":"Successful","description":"User IDs successfully assigned"},"failed":{"items":{"type":"object"},"type":"array","title":"Failed","description":"Failed assignments with reasons"},"total_processed":{"type":"integer","title":"Total Processed","description":"Total number of users processed"}},"type":"object","required":["successful","failed","total_processed"],"title":"BulkRoleAssignmentResponse","description":"Schema for bulk role assignment responses."},"BulkUserOperation":{"properties":{"operation":{"type":"string","pattern":"^(activate|deactivate|force_password_reset|enable_mfa)$","title":"Operation","description":"Operation type"},"user_ids":{"items":{"type":"integer"},"type":"array","minItems":1,"title":"User Ids","description":"List of user IDs"}},"type":"object","required":["operation","user_ids"],"title":"BulkUserOperation","description":"Schema for bulk user operations."},"CSPViolationReport":{"properties":{"document_uri":{"type":"string","title":"Document Uri","description":"URI of the document where violation occurred"},"referrer":{"type":"string","title":"Referrer","description":"Referrer of the document","default":""},"violated_directive":{"type":"string","title":"Violated Directive","description":"The directive that was violated"},"effective_directive":{"type":"string","title":"Effective Directive","description":"The effective directive"},"original_policy":{"type":"string","title":"Original Policy","description":"The original CSP policy"},"blocked_uri":{"type":"string","title":"Blocked Uri","description":"URI that was blocked"},"status_code":{"type":"integer","title":"Status Code","description":"HTTP status code","default":0},"line_number":{"type":"integer","title":"Line Number","description":"Line number where violation occurred","default":0},"column_number":{"type":"integer","title":"Column Number","description":"Column number where violation occurred","default":0},"source_file":{"type":"string","title":"Source File","description":"Source file where violation occurred","default":""}},"type":"object","required":["document_uri","violated_directive","effective_directive","original_policy","blocked_uri"],"title":"CSPViolationReport","description":"CSP violation report from browser."},"CSPViolationReportRequest":{"properties":{"violation":{"$ref":"#/components/schemas/CSPViolationReport"},"timestamp":{"type":"string","title":"Timestamp"},"user_agent":{"type":"string","title":"User Agent"},"url":{"type":"string","title":"Url"},"session_id":{"type":"string","title":"Session Id","description":"Session ID if available","default":""}},"type":"object","required":["violation","timestamp","user_agent","url"],"title":"CSPViolationReportRequest","description":"Complete CSP violation report request."},"ComponentStatus":{"properties":{"status":{"type":"string","title":"Status","description":"Component status"},"response_time_ms":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Response Time Ms","description":"Response time in milliseconds"},"usage_percent":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Usage Percent","description":"Usage percentage"},"total_gb":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Total Gb","description":"Total capacity in GB"},"available_gb":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Available Gb","description":"Available capacity in GB"},"free_gb":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Free Gb","description":"Free capacity in GB"}},"type":"object","required":["status"],"title":"ComponentStatus","description":"Schema for individual component status."},"CreateSecurityEventRequest":{"properties":{"event_type":{"type":"string","title":"Event Type","description":"Type of security event"},"source_ip":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source Ip","description":"Source IP address"},"user_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"User Id","description":"Associated user ID"},"user_agent":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Agent","description":"User agent string"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id","description":"Session ID"},"timestamp":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Timestamp","description":"Event timestamp"},"additional_data":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Additional Data","description":"Additional event data"}},"type":"object","required":["event_type"],"title":"CreateSecurityEventRequest","description":"Schema for creating a security event."},"CryptoParameters":{"properties":{"algorithm":{"type":"string","title":"Algorithm","description":"Encryption algorithm"},"key_derivation":{"type":"string","title":"Key Derivation","description":"Key derivation function"},"min_iterations":{"type":"integer","title":"Min Iterations","description":"Minimum PBKDF2 iterations"},"recommended_iterations":{"type":"integer","title":"Recommended Iterations","description":"Recommended PBKDF2 iterations"},"salt_length":{"type":"integer","title":"Salt Length","description":"Salt length in bytes"},"iv_length":{"type":"integer","title":"Iv Length","description":"IV length in bytes"},"auth_tag_length":{"type":"integer","title":"Auth Tag Length","description":"Authentication tag length in bytes"},"key_length":{"type":"integer","title":"Key Length","description":"Key length in bytes"}},"type":"object","required":["algorithm","key_derivation","min_iterations","recommended_iterations","salt_length","iv_length","auth_tag_length","key_length"],"title":"CryptoParameters","description":"Recommended cryptographic parameters.","example":{"algorithm":"AES-256-GCM","auth_tag_length":16,"iv_length":12,"key_derivation":"PBKDF2-SHA256","key_length":32,"min_iterations":100000,"recommended_iterations":500000,"salt_length":32}},"DecryptDownloadRequest":{"properties":{"password":{"type":"string","title":"Password"}},"type":"object","required":["password"],"title":"DecryptDownloadRequest"},"Document":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"Document or folder name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Document description"},"parent_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Parent Id","description":"Parent folder ID"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"Document tags"},"doc_metadata":{"type":"object","title":"Doc Metadata","description":"Additional metadata"},"is_sensitive":{"type":"boolean","title":"Is Sensitive","description":"Whether document contains sensitive data","default":false},"id":{"type":"integer","title":"Id"},"uuid":{"type":"string","title":"Uuid"},"document_type":{"$ref":"#/components/schemas/DocumentType"},"mime_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mime Type"},"file_size":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"File Size"},"file_extension":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"File Extension"},"path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Path"},"depth_level":{"type":"integer","title":"Depth Level","default":0},"owner_id":{"type":"integer","title":"Owner Id"},"created_by":{"type":"integer","title":"Created By"},"updated_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Updated By"},"status":{"$ref":"#/components/schemas/DocumentStatus"},"share_type":{"$ref":"#/components/schemas/DocumentShareType"},"is_shared":{"type":"boolean","title":"Is Shared","default":false},"is_encrypted":{"type":"boolean","title":"Is Encrypted","default":true},"encryption_algorithm":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Encryption Algorithm"},"encryption_key_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Encryption Key Id"},"encryption_iv":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Encryption Iv"},"encryption_auth_tag":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Encryption Auth Tag"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"accessed_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Accessed At"},"version_number":{"type":"integer","title":"Version Number","default":1},"is_latest_version":{"type":"boolean","title":"Is Latest Version","default":true},"child_count":{"type":"integer","title":"Child Count","default":0},"total_size":{"type":"integer","title":"Total Size","default":0},"full_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Path"},"can_read":{"type":"boolean","title":"Can Read","default":true},"can_write":{"type":"boolean","title":"Can Write","default":false},"can_delete":{"type":"boolean","title":"Can Delete","default":false},"can_share":{"type":"boolean","title":"Can Share","default":false},"author_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Author Name"},"author_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Author Email"},"file_category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"File Category"}},"type":"object","required":["name","id","uuid","document_type","owner_id","created_by","status","share_type","created_at","updated_at"],"title":"Document","description":"Schema for document responses."},"DocumentCopyRequest":{"properties":{"target_parent_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Target Parent Id","description":"Target parent folder ID"},"conflict_resolution":{"type":"string","title":"Conflict Resolution","description":"How to handle name conflicts","default":"rename"},"new_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"New Name","description":"New name for copied document"},"copy_permissions":{"type":"boolean","title":"Copy Permissions","description":"Whether to copy permissions","default":false}},"type":"object","title":"DocumentCopyRequest","description":"Schema for copying documents."},"DocumentCreate":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"Document or folder name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Document description"},"parent_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Parent Id","description":"Parent folder ID"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"Document tags"},"doc_metadata":{"type":"object","title":"Doc Metadata","description":"Additional metadata"},"is_sensitive":{"type":"boolean","title":"Is Sensitive","description":"Whether document contains sensitive data","default":false},"document_type":{"allOf":[{"$ref":"#/components/schemas/DocumentType"}],"description":"Type of document","default":"document"},"share_type":{"allOf":[{"$ref":"#/components/schemas/DocumentShareType"}],"description":"Sharing level","default":"private"}},"type":"object","required":["name"],"title":"DocumentCreate","description":"Schema for creating new documents."},"DocumentFilter":{"properties":{"document_type":{"anyOf":[{"$ref":"#/components/schemas/DocumentType"},{"type":"null"}]},"status":{"anyOf":[{"$ref":"#/components/schemas/DocumentStatus"},{"type":"null"}]},"owner_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Owner Id"},"parent_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Parent Id"},"mime_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mime Type","description":"MIME type or file category (document, image, etc.)"},"is_shared":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Shared"},"is_sensitive":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Sensitive"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"},"created_after":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created After"},"created_before":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created Before"},"updated_after":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated After"},"updated_before":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated Before"},"min_size":{"anyOf":[{"type":"integer","minimum":0.0},{"type":"null"}],"title":"Min Size","description":"Minimum file size in bytes"},"max_size":{"anyOf":[{"type":"integer","minimum":0.0},{"type":"null"}],"title":"Max Size","description":"Maximum file size in bytes"},"author_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Author Id","description":"Document author/creator ID (admin only)"},"file_category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"File Category","description":"File category (document, image, video, etc.)"},"size_range":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Size Range","description":"Smart size range (small, medium, large, huge)"},"date_range":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date Range","description":"Smart date range (today, week, month, year)"}},"type":"object","title":"DocumentFilter","description":"Schema for document filtering with enhanced capabilities."},"DocumentList":{"properties":{"documents":{"items":{"$ref":"#/components/schemas/Document"},"type":"array","title":"Documents"},"total":{"type":"integer","title":"Total","description":"Total number of documents"},"page":{"type":"integer","title":"Page","description":"Current page number"},"size":{"type":"integer","title":"Size","description":"Page size"},"has_next":{"type":"boolean","title":"Has Next","description":"Whether there are more pages"}},"type":"object","required":["documents","total","page","size","has_next"],"title":"DocumentList","description":"Schema for paginated document lists."},"DocumentMoveRequest":{"properties":{"target_parent_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Target Parent Id","description":"Target parent folder ID"},"conflict_resolution":{"type":"string","title":"Conflict Resolution","description":"How to handle name conflicts","default":"rename"}},"type":"object","title":"DocumentMoveRequest","description":"Schema for moving documents."},"DocumentPermission":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"User ID"},"permission_type":{"allOf":[{"$ref":"#/components/schemas/PermissionType"}],"description":"Permission type"},"granted":{"type":"boolean","title":"Granted","description":"Whether permission is granted","default":true},"inheritable":{"type":"boolean","title":"Inheritable","description":"Whether permission is inheritable","default":true},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"Permission expiration"},"conditions":{"type":"object","title":"Conditions","description":"Permission conditions"},"id":{"type":"integer","title":"Id"},"document_id":{"type":"integer","title":"Document Id"},"granted_at":{"type":"string","format":"date-time","title":"Granted At"},"granted_by":{"type":"integer","title":"Granted By"},"revoked_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Revoked At"},"revoked_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Revoked By"}},"type":"object","required":["user_id","permission_type","id","document_id","granted_at","granted_by"],"title":"DocumentPermission","description":"Schema for document permission responses."},"DocumentPermissionCreate":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"User ID"},"permission_type":{"allOf":[{"$ref":"#/components/schemas/PermissionType"}],"description":"Permission type"},"granted":{"type":"boolean","title":"Granted","description":"Whether permission is granted","default":true},"inheritable":{"type":"boolean","title":"Inheritable","description":"Whether permission is inheritable","default":true},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"Permission expiration"},"conditions":{"type":"object","title":"Conditions","description":"Permission conditions"}},"type":"object","required":["user_id","permission_type"],"title":"DocumentPermissionCreate","description":"Schema for creating document permissions."},"DocumentSearch":{"properties":{"query":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Query","description":"Search query"},"filters":{"allOf":[{"$ref":"#/components/schemas/DocumentFilter"}],"description":"Search filters"},"sort_by":{"type":"string","title":"Sort By","description":"Sort field","default":"updated_at"},"sort_order":{"type":"string","title":"Sort Order","description":"Sort order (asc/desc)","default":"desc"},"page":{"type":"integer","minimum":1.0,"title":"Page","description":"Page number","default":1},"size":{"type":"integer","maximum":100.0,"minimum":1.0,"title":"Size","description":"Page size","default":20}},"type":"object","title":"DocumentSearch","description":"Schema for document search."},"DocumentShareType":{"type":"string","enum":["private","internal","external","public"],"title":"DocumentShareType","description":"Document share type enumeration."},"DocumentStatistics":{"properties":{"total_documents":{"type":"integer","title":"Total Documents","default":0},"total_folders":{"type":"integer","title":"Total Folders","default":0},"total_size":{"type":"integer","title":"Total Size","default":0},"encrypted_documents":{"type":"integer","title":"Encrypted Documents","default":0},"shared_documents":{"type":"integer","title":"Shared Documents","default":0},"sensitive_documents":{"type":"integer","title":"Sensitive Documents","default":0},"documents_by_type":{"additionalProperties":{"type":"integer"},"type":"object","title":"Documents By Type"},"documents_by_status":{"additionalProperties":{"type":"integer"},"type":"object","title":"Documents By Status"},"storage_usage_by_user":{"additionalProperties":{"type":"integer"},"type":"object","title":"Storage Usage By User"},"recent_activity_count":{"type":"integer","title":"Recent Activity Count","default":0},"active_documents":{"type":"integer","title":"Active Documents","default":0},"archived_documents":{"type":"integer","title":"Archived Documents","default":0},"deleted_documents":{"type":"integer","title":"Deleted Documents","default":0},"active_storage_size":{"type":"integer","title":"Active Storage Size","default":0},"archived_storage_size":{"type":"integer","title":"Archived Storage Size","default":0},"deleted_storage_size":{"type":"integer","title":"Deleted Storage Size","default":0},"documents_created_today":{"type":"integer","title":"Documents Created Today","default":0},"documents_modified_today":{"type":"integer","title":"Documents Modified Today","default":0},"avg_document_size":{"type":"number","title":"Avg Document Size","default":0.0},"largest_document_size":{"type":"integer","title":"Largest Document Size","default":0}},"type":"object","title":"DocumentStatistics","description":"Schema for document statistics."},"DocumentStatus":{"type":"string","enum":["active","archived","deleted","quarantined"],"title":"DocumentStatus","description":"Document status enumeration."},"DocumentTree":{"properties":{"document":{"$ref":"#/components/schemas/Document"},"children":{"items":{"$ref":"#/components/schemas/DocumentTree"},"type":"array","title":"Children","description":"Child documents"}},"type":"object","required":["document"],"title":"DocumentTree","description":"Schema for hierarchical document tree."},"DocumentType":{"type":"string","enum":["document","folder"],"title":"DocumentType","description":"Document type enumeration."},"DocumentUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"parent_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Parent Id"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"},"doc_metadata":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Doc Metadata"},"is_sensitive":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Sensitive"},"share_type":{"anyOf":[{"$ref":"#/components/schemas/DocumentShareType"},{"type":"null"}]}},"type":"object","title":"DocumentUpdate","description":"Schema for updating documents."},"EncryptionHealthCheck":{"properties":{"status":{"type":"string","title":"Status","description":"Overall health status"},"crypto_functional":{"type":"boolean","title":"Crypto Functional","description":"Whether crypto operations work"},"user_keys_count":{"type":"integer","title":"User Keys Count","description":"Number of user keys"},"audit_logs_count":{"type":"integer","title":"Audit Logs Count","description":"Number of audit log entries"},"escrow_enabled":{"type":"boolean","title":"Escrow Enabled","description":"Whether key escrow is enabled"},"supported_algorithms":{"items":{"type":"string"},"type":"array","title":"Supported Algorithms","description":"Supported encryption algorithms"},"supported_kdf":{"items":{"type":"string"},"type":"array","title":"Supported Kdf","description":"Supported key derivation functions"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if unhealthy"}},"type":"object","required":["status","crypto_functional","user_keys_count","audit_logs_count","escrow_enabled","supported_algorithms","supported_kdf"],"title":"EncryptionHealthCheck","description":"Health check response schema.","example":{"audit_logs_count":150,"crypto_functional":true,"escrow_enabled":true,"status":"healthy","supported_algorithms":["AES-256-GCM"],"supported_kdf":["PBKDF2-SHA256"],"user_keys_count":5}},"EncryptionKeyCreate":{"properties":{"password":{"type":"string","title":"Password","description":"Master password for key derivation"},"iterations":{"type":"integer","minimum":100000.0,"title":"Iterations","description":"PBKDF2 iterations (min 100,000)"},"salt":{"type":"string","title":"Salt","description":"Base64 encoded salt"},"hint":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Hint","description":"Password hint"},"validation_ciphertext":{"type":"string","title":"Validation Ciphertext","description":"Base64 encoded validation ciphertext"},"validation_iv":{"type":"string","title":"Validation Iv","description":"Base64 encoded validation IV"},"validation_auth_tag":{"type":"string","title":"Validation Auth Tag","description":"Base64 encoded validation auth tag"},"replace_existing":{"type":"boolean","title":"Replace Existing","description":"Replace existing active key","default":false}},"type":"object","required":["password","iterations","salt","validation_ciphertext","validation_iv","validation_auth_tag"],"title":"EncryptionKeyCreate","description":"Request schema for creating encryption keys.","example":{"hint":"My favorite password","iterations":500000,"password":"SecurePassword123!","replace_existing":false,"salt":"base64encodedSalt==","validation_auth_tag":"authTag==","validation_ciphertext":"encryptedValidationData==","validation_iv":"randomIV=="}},"EncryptionKeyList":{"properties":{"keys":{"items":{"$ref":"#/components/schemas/EncryptionKeyResponse"},"type":"array","title":"Keys","description":"List of encryption keys"},"total":{"type":"integer","title":"Total","description":"Total number of keys"},"active_count":{"type":"integer","title":"Active Count","description":"Number of active keys"}},"type":"object","required":["keys","total","active_count"],"title":"EncryptionKeyList","description":"Response schema for listing encryption keys."},"EncryptionKeyResponse":{"properties":{"key_id":{"type":"string","title":"Key Id","description":"Unique key identifier"},"algorithm":{"type":"string","title":"Algorithm","description":"Encryption algorithm"},"key_derivation_method":{"type":"string","title":"Key Derivation Method","description":"Key derivation method"},"iterations":{"type":"integer","title":"Iterations","description":"PBKDF2 iterations"},"salt":{"type":"string","title":"Salt","description":"Base64 encoded salt"},"hint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Hint","description":"Password hint"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether key is active"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"Expiration timestamp"},"deactivated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Deactivated At","description":"Deactivation timestamp"},"deactivated_reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Deactivated Reason","description":"Deactivation reason"},"escrow_available":{"type":"boolean","title":"Escrow Available","description":"Whether key escrow is available"}},"type":"object","required":["key_id","algorithm","key_derivation_method","iterations","salt","is_active","created_at","escrow_available"],"title":"EncryptionKeyResponse","description":"Response schema for encryption keys."},"EncryptionValidationRequest":{"properties":{"key":{"type":"string","title":"Key","description":"Base64 encoded encryption key"},"iv":{"type":"string","title":"Iv","description":"Base64 encoded initialization vector"},"auth_tag":{"type":"string","title":"Auth Tag","description":"Base64 encoded authentication tag"},"ciphertext":{"type":"string","title":"Ciphertext","description":"Base64 encoded ciphertext"},"aad":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Aad","description":"Additional authenticated data"}},"type":"object","required":["key","iv","auth_tag","ciphertext"],"title":"EncryptionValidationRequest","description":"Request schema for encryption validation.","example":{"aad":"optional additional data","auth_tag":"base64encodedTag==","ciphertext":"base64encodedCiphertext==","iv":"base64encodedIV==","key":"base64encodedKey=="}},"EncryptionValidationResponse":{"properties":{"valid":{"type":"boolean","title":"Valid","description":"Whether validation succeeded"},"algorithm":{"type":"string","title":"Algorithm","description":"Encryption algorithm used"},"plaintext_hash":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Plaintext Hash","description":"SHA256 hash of decrypted plaintext"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message","description":"Error message if validation failed"}},"type":"object","required":["valid","algorithm"],"title":"EncryptionValidationResponse","description":"Response schema for encryption validation."},"EventStatus":{"type":"string","enum":["active","investigating","resolved","false_positive"],"title":"EventStatus","description":"Security event status."},"FolderCreationItem":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"Folder name"},"path":{"type":"string","title":"Path","description":"Full folder path relative to parent"},"parent_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Parent Path","description":"Parent folder path"},"description":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Description","description":"Folder description"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"Folder tags"}},"type":"object","required":["name","path"],"title":"FolderCreationItem","description":"Schema for individual folder creation item."},"FolderStructureItem-Input":{"properties":{"name":{"type":"string","title":"Name","description":"Name of the folder/document"},"type":{"type":"string","title":"Type","description":"'folder' or 'document'"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Description of this item"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"Default tags for this item"},"children":{"items":{"$ref":"#/components/schemas/FolderStructureItem-Input"},"type":"array","title":"Children","description":"Nested items"},"document_template":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Document Template","description":"Template content for documents"},"permissions":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Permissions","description":"Default permissions"},"metadata":{"type":"object","title":"Metadata","description":"Additional metadata"}},"type":"object","required":["name","type"],"title":"FolderStructureItem","description":"Individual folder or document in template structure","example":{"children":[{"description":"Business requirements document","document_template":"# Business Requirements\n\n## Overview\n\n## Stakeholders\n\n## Requirements","name":"Business Requirements.md","tags":["requirements","business"],"type":"document"}],"description":"Project requirements and specifications","name":"Requirements","tags":["requirements","planning"],"type":"folder"}},"FolderStructureItem-Output":{"properties":{"name":{"type":"string","title":"Name","description":"Name of the folder/document"},"type":{"type":"string","title":"Type","description":"'folder' or 'document'"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Description of this item"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"Default tags for this item"},"children":{"items":{"$ref":"#/components/schemas/FolderStructureItem-Output"},"type":"array","title":"Children","description":"Nested items"},"document_template":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Document Template","description":"Template content for documents"},"permissions":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Permissions","description":"Default permissions"},"metadata":{"type":"object","title":"Metadata","description":"Additional metadata"}},"type":"object","required":["name","type"],"title":"FolderStructureItem","description":"Individual folder or document in template structure","example":{"children":[{"description":"Business requirements document","document_template":"# Business Requirements\n\n## Overview\n\n## Stakeholders\n\n## Requirements","name":"Business Requirements.md","tags":["requirements","business"],"type":"document"}],"description":"Project requirements and specifications","name":"Requirements","tags":["requirements","planning"],"type":"folder"}},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IPBlockRequest":{"properties":{"ip_address":{"type":"string","title":"Ip Address","description":"IP address to block"},"reason":{"type":"string","title":"Reason","description":"Reason for blocking"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"Block expiration time"},"is_permanent":{"type":"boolean","title":"Is Permanent","description":"Whether block is permanent","default":false}},"type":"object","required":["ip_address","reason"],"title":"IPBlockRequest","description":"Schema for blocking an IP address."},"IPBlocklistResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Block entry ID"},"ip_address":{"type":"string","title":"Ip Address","description":"Blocked IP address"},"reason":{"type":"string","title":"Reason","description":"Block reason"},"blocked_at":{"type":"string","format":"date-time","title":"Blocked At","description":"Block timestamp"},"blocked_by":{"type":"string","title":"Blocked By","description":"Who blocked the IP"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"Block expiration"},"is_permanent":{"type":"boolean","title":"Is Permanent","description":"Whether block is permanent"},"block_count":{"type":"integer","title":"Block Count","description":"Number of times blocked"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether block is currently active"}},"type":"object","required":["id","ip_address","reason","blocked_at","blocked_by","is_permanent","block_count","is_active"],"title":"IPBlocklistResponse","description":"Schema for IP blocklist entry."},"KeyDerivationResponse":{"properties":{"derived_key":{"type":"string","title":"Derived Key","description":"Base64 encoded derived key"},"key_hash":{"type":"string","title":"Key Hash","description":"SHA256 hash of derived key"},"algorithm":{"type":"string","title":"Algorithm","description":"Key derivation algorithm"},"iterations":{"type":"integer","title":"Iterations","description":"PBKDF2 iterations used"}},"type":"object","required":["derived_key","key_hash","algorithm","iterations"],"title":"KeyDerivationResponse","description":"Response schema for key derivation."},"KeyEscrowCreate":{"properties":{"key_id":{"type":"string","title":"Key Id","description":"Key ID to escrow"},"encrypted_key_material":{"type":"string","title":"Encrypted Key Material","description":"Encrypted key material"},"escrow_method":{"type":"string","title":"Escrow Method","description":"Escrow method"},"recovery_hint":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Recovery Hint","description":"Recovery hint"}},"type":"object","required":["key_id","encrypted_key_material","escrow_method"],"title":"KeyEscrowCreate","description":"Request schema for creating key escrow."},"KeyEscrowResponse":{"properties":{"escrow_id":{"type":"integer","title":"Escrow Id","description":"Escrow record ID"},"key_id":{"type":"string","title":"Key Id","description":"Key ID"},"user_id":{"type":"integer","title":"User Id","description":"User ID"},"escrow_method":{"type":"string","title":"Escrow Method","description":"Escrow method"},"recovery_hint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Recovery Hint","description":"Recovery hint"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"created_by":{"type":"integer","title":"Created By","description":"Created by user ID"}},"type":"object","required":["escrow_id","key_id","user_id","escrow_method","created_at","created_by"],"title":"KeyEscrowResponse","description":"Response schema for key escrow."},"KeyRecoveryRequest":{"properties":{"key_id":{"type":"string","title":"Key Id","description":"Key ID to recover"},"recovery_reason":{"type":"string","title":"Recovery Reason","description":"Reason for recovery"}},"type":"object","required":["key_id","recovery_reason"],"title":"KeyRecoveryRequest","description":"Request schema for key recovery.","example":{"key_id":"key_123_abc456","recovery_reason":"User forgot password, emergency access needed"}},"KeyRecoveryResponse":{"properties":{"key_id":{"type":"string","title":"Key Id","description":"Key ID"},"user_id":{"type":"integer","title":"User Id","description":"User ID"},"escrow_data":{"type":"string","title":"Escrow Data","description":"Encrypted key material"},"escrow_method":{"type":"string","title":"Escrow Method","description":"Escrow method"},"recovery_hint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Recovery Hint","description":"Recovery hint"},"recovered_at":{"type":"string","format":"date-time","title":"Recovered At","description":"Recovery timestamp"},"recovered_by":{"type":"integer","title":"Recovered By","description":"Recovered by user ID"}},"type":"object","required":["key_id","user_id","escrow_data","escrow_method","recovered_at","recovered_by"],"title":"KeyRecoveryResponse","description":"Response schema for key recovery."},"KeyRotationRequest":{"properties":{"key_type":{"type":"string","title":"Key Type"},"force_rotation":{"type":"boolean","title":"Force Rotation","default":false}},"type":"object","required":["key_type"],"title":"KeyRotationRequest"},"LoginRequest":{"properties":{"username":{"type":"string","maxLength":50,"minLength":1,"title":"Username","description":"Username"},"password":{"type":"string","minLength":1,"title":"Password","description":"Password"}},"type":"object","required":["username","password"],"title":"LoginRequest","description":"Schema for login request payload."},"LoginResponse":{"properties":{"access_token":{"type":"string","title":"Access Token","description":"JWT access token"},"refresh_token":{"type":"string","title":"Refresh Token","description":"JWT refresh token"},"token_type":{"type":"string","title":"Token Type","description":"Token type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In","description":"Token expiration time in seconds"},"user_id":{"type":"integer","title":"User Id","description":"User ID"},"username":{"type":"string","title":"Username","description":"Username"},"role":{"type":"string","title":"Role","description":"User role"},"must_change_password":{"type":"boolean","title":"Must Change Password","description":"Whether user must change password","default":false},"mfa_required":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Mfa Required","description":"Whether MFA is required"},"temp_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Temp Token","description":"Temporary token for MFA completion"},"encryption_salt":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Encryption Salt","description":"Base64 encoded salt for key derivation"},"key_verification_payload":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Key Verification Payload","description":"Encrypted payload for key verification"},"encryption_method":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Encryption Method","description":"Key derivation method"},"key_derivation_iterations":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Key Derivation Iterations","description":"PBKDF2 iterations count"}},"type":"object","required":["access_token","refresh_token","expires_in","user_id","username","role"],"title":"LoginResponse","description":"Schema for successful login response."},"MFADisableRequest":{"properties":{"password":{"type":"string","title":"Password","description":"User's current password for verification"},"admin_override":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Admin Override","description":"Admin override flag (admin users only)","default":false}},"type":"object","required":["password"],"title":"MFADisableRequest","description":"Request schema for disabling MFA."},"MFAHealthResponse":{"properties":{"totp_service_available":{"type":"boolean","title":"Totp Service Available","description":"TOTP service status"},"qr_code_service_available":{"type":"boolean","title":"Qr Code Service Available","description":"QR code service status"},"backup_codes_service_available":{"type":"boolean","title":"Backup Codes Service Available","description":"Backup codes service status"},"database_connection":{"type":"boolean","title":"Database Connection","description":"Database connection status"},"rate_limiting_active":{"type":"boolean","title":"Rate Limiting Active","description":"Rate limiting status"},"errors":{"items":{"type":"string"},"type":"array","title":"Errors","description":"Any service errors detected"},"warnings":{"items":{"type":"string"},"type":"array","title":"Warnings","description":"Any service warnings"}},"type":"object","required":["totp_service_available","qr_code_service_available","backup_codes_service_available","database_connection","rate_limiting_active"],"title":"MFAHealthResponse","description":"Response schema for MFA health check."},"MFAResetRequest":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"User ID to reset MFA for"},"reason":{"type":"string","maxLength":500,"minLength":10,"title":"Reason","description":"Reason for MFA reset (for audit log)"}},"type":"object","required":["user_id","reason"],"title":"MFAResetRequest","description":"Request schema for admin MFA reset."},"MFAResetResponse":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether reset was successful"},"user_id":{"type":"integer","title":"User Id","description":"User ID that was reset"},"reset_by":{"type":"integer","title":"Reset By","description":"Admin user ID who performed reset"},"reset_at":{"type":"string","format":"date-time","title":"Reset At","description":"When the reset occurred"}},"type":"object","required":["success","user_id","reset_by","reset_at"],"title":"MFAResetResponse","description":"Response schema for MFA reset."},"MFASetupRequest":{"properties":{"password":{"type":"string","title":"Password","description":"User's current password for verification"},"issuer":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Issuer","description":"Issuer name for TOTP (shown in authenticator app)","default":"SecureVault"}},"type":"object","required":["password"],"title":"MFASetupRequest","description":"Request schema for MFA setup."},"MFASetupResponse":{"properties":{"secret":{"type":"string","title":"Secret","description":"Base32-encoded TOTP secret"},"qr_code_url":{"type":"string","title":"Qr Code Url","description":"TOTP provisioning URI for QR code"},"qr_code_data_uri":{"type":"string","title":"Qr Code Data Uri","description":"QR code as data URI for display"},"backup_codes":{"items":{"type":"string"},"type":"array","title":"Backup Codes","description":"Recovery backup codes"}},"type":"object","required":["secret","qr_code_url","qr_code_data_uri","backup_codes"],"title":"MFASetupResponse","description":"Response schema for MFA setup."},"MFAStatsResponse":{"properties":{"total_users":{"type":"integer","title":"Total Users","description":"Total number of users"},"mfa_enabled_users":{"type":"integer","title":"Mfa Enabled Users","description":"Users with MFA enabled"},"mfa_enabled_percentage":{"type":"number","title":"Mfa Enabled Percentage","description":"Percentage with MFA enabled"},"backup_codes_exhausted":{"type":"integer","title":"Backup Codes Exhausted","description":"Users with all backup codes used","default":0},"recent_mfa_setups":{"type":"integer","title":"Recent Mfa Setups","description":"MFA setups in last 30 days","default":0}},"type":"object","required":["total_users","mfa_enabled_users","mfa_enabled_percentage"],"title":"MFAStatsResponse","description":"Response schema for MFA statistics (admin only)."},"MFAStatus":{"properties":{"enabled":{"type":"boolean","title":"Enabled","description":"Whether MFA is enabled"},"setup_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Setup Date","description":"When MFA was first enabled"},"backup_codes_remaining":{"type":"integer","title":"Backup Codes Remaining","description":"Number of unused backup codes","default":0},"last_used":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Used","description":"When MFA was last used for authentication"},"required_by_policy":{"type":"boolean","title":"Required By Policy","description":"Whether MFA is required by admin policy","default":false}},"type":"object","required":["enabled"],"title":"MFAStatus","description":"Schema for MFA status information."},"MFAVerificationRequest":{"properties":{"temp_token":{"type":"string","title":"Temp Token","description":"Temporary token from initial login"},"mfa_code":{"type":"string","maxLength":6,"minLength":6,"title":"Mfa Code","description":"6-digit TOTP code"}},"type":"object","required":["temp_token","mfa_code"],"title":"MFAVerificationRequest","description":"Schema for MFA verification request."},"MFAVerifyRequest":{"properties":{"code":{"type":"string","maxLength":8,"minLength":6,"title":"Code","description":"TOTP code or backup code"}},"type":"object","required":["code"],"title":"MFAVerifyRequest","description":"Request schema for MFA code verification."},"MFAVerifyResponse":{"properties":{"verified":{"type":"boolean","title":"Verified","description":"Whether code was valid"},"backup_code_used":{"type":"boolean","title":"Backup Code Used","description":"Whether a backup code was used","default":false},"backup_codes_remaining":{"type":"integer","title":"Backup Codes Remaining","description":"Number of unused backup codes remaining","default":0}},"type":"object","required":["verified"],"title":"MFAVerifyResponse","description":"Response schema for MFA verification."},"PasswordRequest":{"properties":{"password":{"type":"string","title":"Password"}},"type":"object","required":["password"],"title":"PasswordRequest"},"PasswordResetRequest":{"properties":{"new_password":{"type":"string","minLength":8,"title":"New Password","description":"New password"},"force_change_on_login":{"type":"boolean","title":"Force Change On Login","description":"Force password change on next login","default":false}},"type":"object","required":["new_password"],"title":"PasswordResetRequest","description":"Schema for password reset request."},"Permission":{"properties":{"name":{"type":"string","maxLength":100,"minLength":3,"title":"Name","description":"Permission name (e.g., 'documents:read')"},"display_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Display Name","description":"Human-readable permission name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Permission description"},"resource_type":{"type":"string","title":"Resource Type","description":"Resource type this permission applies to"},"action":{"type":"string","title":"Action","description":"Action this permission allows"},"requires_resource_ownership":{"type":"boolean","title":"Requires Resource Ownership","description":"Whether permission requires owning the resource","default":false},"id":{"type":"integer","title":"Id"},"is_system":{"type":"boolean","title":"Is System","description":"Whether this is a system permission"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["name","resource_type","action","id","is_system","created_at","updated_at"],"title":"Permission","description":"Schema for permission responses."},"PermissionCheckRequest":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"ID of the user"},"permission":{"type":"string","title":"Permission","description":"Permission to check"},"resource_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resource Type","description":"Type of resource"},"resource_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Resource Id","description":"ID of specific resource"},"context":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Context","description":"Additional context for permission check"}},"type":"object","required":["user_id","permission"],"title":"PermissionCheckRequest","description":"Schema for permission check requests."},"PermissionCheckResponse":{"properties":{"granted":{"type":"boolean","title":"Granted","description":"Whether permission is granted"},"reason":{"type":"string","title":"Reason","description":"Reason for grant or denial"},"source":{"type":"string","title":"Source","description":"Source of permission (role, resource, etc.)"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"When permission expires"}},"type":"object","required":["granted","reason","source"],"title":"PermissionCheckResponse","description":"Schema for permission check responses."},"PermissionCreate":{"properties":{"name":{"type":"string","maxLength":100,"minLength":3,"title":"Name","description":"Permission name (e.g., 'documents:read')"},"display_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Display Name","description":"Human-readable permission name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Permission description"},"resource_type":{"type":"string","title":"Resource Type","description":"Resource type this permission applies to"},"action":{"type":"string","title":"Action","description":"Action this permission allows"},"requires_resource_ownership":{"type":"boolean","title":"Requires Resource Ownership","description":"Whether permission requires owning the resource","default":false}},"type":"object","required":["name","resource_type","action"],"title":"PermissionCreate","description":"Schema for creating new permissions."},"PermissionListResponse":{"properties":{"permissions":{"items":{"$ref":"#/components/schemas/Permission"},"type":"array","title":"Permissions"},"total":{"type":"integer","title":"Total","description":"Total number of permissions"},"page":{"type":"integer","title":"Page","description":"Current page number"},"size":{"type":"integer","title":"Size","description":"Page size"},"has_next":{"type":"boolean","title":"Has Next","description":"Whether there are more pages"}},"type":"object","required":["permissions","total","page","size","has_next"],"title":"PermissionListResponse","description":"Schema for paginated permission list responses."},"PermissionType":{"type":"string","enum":["read","write","delete","admin","share"],"title":"PermissionType","description":"Permission type enumeration."},"ProjectTemplate":{"properties":{"id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Id","description":"Template ID"},"name":{"type":"string","title":"Name","description":"Template name"},"description":{"type":"string","title":"Description","description":"Template description"},"category":{"allOf":[{"$ref":"#/components/schemas/TemplateCategory"}],"description":"Template category"},"icon":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Icon","description":"Icon name for UI"},"color":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Color","description":"Color theme for UI"},"structure":{"items":{"$ref":"#/components/schemas/FolderStructureItem-Output"},"type":"array","title":"Structure","description":"Folder structure definition"},"default_tags":{"items":{"type":"string"},"type":"array","title":"Default Tags","description":"Default tags applied to root folder"},"default_permissions":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Default Permissions","description":"Default permissions"},"default_metadata":{"type":"object","title":"Default Metadata","description":"Default metadata"},"variables":{"items":{"type":"string"},"type":"array","title":"Variables","description":"Available variables for this template"},"allow_customization":{"type":"boolean","title":"Allow Customization","description":"Allow users to modify structure","default":true},"is_system_template":{"type":"boolean","title":"Is System Template","description":"System-provided template (non-editable)","default":false},"created_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Created By","description":"User ID who created template"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At","description":"Creation timestamp"},"updated_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Updated By","description":"User ID who last updated"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At","description":"Last update timestamp"},"version":{"type":"integer","title":"Version","description":"Template version","default":1},"usage_count":{"type":"integer","title":"Usage Count","description":"Number of times template has been used","default":0},"last_used":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Used","description":"Last time template was used"}},"type":"object","required":["name","description","category","structure"],"title":"ProjectTemplate","description":"Project template definition","example":{"category":"development","color":"blue","default_tags":["project","development"],"description":"Complete folder structure for software development projects","icon":"code","name":"Software Development Project","structure":[{"children":[{"name":"Business Requirements.md","tags":["requirements","business"],"type":"document"}],"description":"Project requirements and specifications","name":"Requirements","tags":["requirements","planning"],"type":"folder"},{"description":"System design and architecture","name":"Design","tags":["design","architecture"],"type":"folder"}],"variables":["project_name","date","department"]}},"QRCodeRequest":{"properties":{"format":{"anyOf":[{"type":"string","pattern":"^(data_uri|png|svg)$"},{"type":"null"}],"title":"Format","description":"QR code format: data_uri, png, or svg","default":"data_uri"},"size":{"anyOf":[{"type":"integer","maximum":20.0,"minimum":5.0},{"type":"null"}],"title":"Size","description":"QR code module size","default":10}},"type":"object","title":"QRCodeRequest","description":"Request schema for QR code generation."},"QRCodeResponse":{"properties":{"qr_code":{"type":"string","title":"Qr Code","description":"QR code in requested format"},"format":{"type":"string","title":"Format","description":"Format of the QR code"},"provisioning_uri":{"type":"string","title":"Provisioning Uri","description":"TOTP provisioning URI"}},"type":"object","required":["qr_code","format","provisioning_uri"],"title":"QRCodeResponse","description":"Response schema for QR code generation."},"ResourcePermission":{"properties":{"resource_type":{"type":"string","title":"Resource Type","description":"Type of resource"},"resource_id":{"type":"integer","title":"Resource Id","description":"ID of the specific resource"},"subject_type":{"allOf":[{"$ref":"#/components/schemas/SubjectType"}],"description":"Type of subject (user or role)"},"subject_id":{"type":"integer","title":"Subject Id","description":"ID of the subject"},"permission":{"type":"string","title":"Permission","description":"Permission level"},"granted":{"type":"boolean","title":"Granted","description":"Whether permission is granted or denied","default":true},"inheritable":{"type":"boolean","title":"Inheritable","description":"Whether permission can be inherited","default":true},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"When this permission expires"},"conditions":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Conditions","description":"Conditional access rules"},"id":{"type":"integer","title":"Id"},"granted_at":{"type":"string","format":"date-time","title":"Granted At"},"granted_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Granted By","description":"ID of user who granted permission"},"inherited_from":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Inherited From","description":"ID of parent permission if inherited"}},"type":"object","required":["resource_type","resource_id","subject_type","subject_id","permission","id","granted_at"],"title":"ResourcePermission","description":"Schema for resource permission responses."},"ResourcePermissionCreate":{"properties":{"resource_type":{"type":"string","title":"Resource Type","description":"Type of resource"},"resource_id":{"type":"integer","title":"Resource Id","description":"ID of the specific resource"},"subject_type":{"allOf":[{"$ref":"#/components/schemas/SubjectType"}],"description":"Type of subject (user or role)"},"subject_id":{"type":"integer","title":"Subject Id","description":"ID of the subject"},"permission":{"type":"string","title":"Permission","description":"Permission level"},"granted":{"type":"boolean","title":"Granted","description":"Whether permission is granted or denied","default":true},"inheritable":{"type":"boolean","title":"Inheritable","description":"Whether permission can be inherited","default":true},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"When this permission expires"},"conditions":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Conditions","description":"Conditional access rules"}},"type":"object","required":["resource_type","resource_id","subject_type","subject_id","permission"],"title":"ResourcePermissionCreate","description":"Schema for creating resource permissions."},"Role":{"properties":{"name":{"type":"string","maxLength":50,"minLength":2,"title":"Name","description":"Role name"},"display_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Display Name","description":"Human-readable role name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Role description"},"hierarchy_level":{"type":"integer","title":"Hierarchy Level","description":"Role hierarchy level"},"id":{"type":"integer","title":"Id"},"is_system":{"type":"boolean","title":"Is System","description":"Whether this is a system role"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether this role is active"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"permissions":{"items":{"$ref":"#/components/schemas/Permission"},"type":"array","title":"Permissions","description":"Permissions assigned to this role"}},"type":"object","required":["name","hierarchy_level","id","is_system","is_active","created_at","updated_at"],"title":"Role","description":"Schema for role responses."},"RoleCreate":{"properties":{"name":{"type":"string","maxLength":50,"minLength":2,"title":"Name","description":"Role name"},"display_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Display Name","description":"Human-readable role name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Role description"},"hierarchy_level":{"anyOf":[{"type":"integer","maximum":5.0,"minimum":1.0},{"type":"null"}],"title":"Hierarchy Level","description":"Role hierarchy level (1-5)"},"permissions":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Permissions","description":"List of permission names to assign"}},"type":"object","required":["name"],"title":"RoleCreate","description":"Schema for creating new roles."},"RoleListResponse":{"properties":{"roles":{"items":{"$ref":"#/components/schemas/RoleWithStats"},"type":"array","title":"Roles"},"total":{"type":"integer","title":"Total","description":"Total number of roles"},"page":{"type":"integer","title":"Page","description":"Current page number"},"size":{"type":"integer","title":"Size","description":"Page size"},"has_next":{"type":"boolean","title":"Has Next","description":"Whether there are more pages"}},"type":"object","required":["roles","total","page","size","has_next"],"title":"RoleListResponse","description":"Schema for paginated role list responses."},"RoleUpdate":{"properties":{"display_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Display Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"permissions":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Permissions","description":"List of permission names to assign"}},"type":"object","title":"RoleUpdate","description":"Schema for updating roles."},"RoleWithStats":{"properties":{"name":{"type":"string","maxLength":50,"minLength":2,"title":"Name","description":"Role name"},"display_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Display Name","description":"Human-readable role name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Role description"},"hierarchy_level":{"type":"integer","title":"Hierarchy Level","description":"Role hierarchy level"},"id":{"type":"integer","title":"Id"},"is_system":{"type":"boolean","title":"Is System","description":"Whether this is a system role"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether this role is active"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"permissions":{"items":{"$ref":"#/components/schemas/Permission"},"type":"array","title":"Permissions","description":"Permissions assigned to this role"},"user_count":{"type":"integer","title":"User Count","description":"Number of users with this role"},"permission_count":{"type":"integer","title":"Permission Count","description":"Number of permissions assigned to this role"}},"type":"object","required":["name","hierarchy_level","id","is_system","is_active","created_at","updated_at","user_count","permission_count"],"title":"RoleWithStats","description":"Schema for role responses with usage statistics."},"SecurityDashboardResponse":{"properties":{"period_hours":{"type":"integer","title":"Period Hours","description":"Period covered in hours"},"event_counts":{"additionalProperties":{"type":"integer"},"type":"object","title":"Event Counts","description":"Event counts by threat level"},"active_threats":{"type":"integer","title":"Active Threats","description":"Number of active threats"},"blocked_ips":{"type":"integer","title":"Blocked Ips","description":"Number of blocked IPs"},"recent_events":{"items":{"type":"object"},"type":"array","title":"Recent Events","description":"Recent high-priority events"},"top_threat_sources":{"items":{"type":"object"},"type":"array","title":"Top Threat Sources","description":"Top threat source IPs"}},"type":"object","required":["period_hours","event_counts","active_threats","blocked_ips","recent_events","top_threat_sources"],"title":"SecurityDashboardResponse","description":"Schema for security dashboard data."},"SecurityEventListResponse":{"properties":{"events":{"items":{"$ref":"#/components/schemas/SecurityEventResponse"},"type":"array","title":"Events","description":"List of security events"},"total":{"type":"integer","title":"Total","description":"Total number of events"},"page":{"type":"integer","title":"Page","description":"Current page number"},"size":{"type":"integer","title":"Size","description":"Page size"},"has_next":{"type":"boolean","title":"Has Next","description":"Whether there are more pages"}},"type":"object","required":["events","total","page","size","has_next"],"title":"SecurityEventListResponse","description":"Schema for paginated security event list response."},"SecurityEventResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Event database ID"},"event_id":{"type":"string","title":"Event Id","description":"Unique event identifier"},"event_type":{"type":"string","title":"Event Type","description":"Type of security event"},"threat_level":{"allOf":[{"$ref":"#/components/schemas/ThreatLevel"}],"description":"Threat severity level"},"status":{"allOf":[{"$ref":"#/components/schemas/EventStatus"}],"description":"Event status"},"title":{"type":"string","title":"Title","description":"Event title"},"description":{"type":"string","title":"Description","description":"Event description"},"source_ip":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source Ip","description":"Source IP address"},"user_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"User Id","description":"Associated user ID"},"document_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Document Id","description":"Associated document ID"},"risk_score":{"type":"number","title":"Risk Score","description":"Risk score (0-10)"},"confidence":{"type":"number","title":"Confidence","description":"Detection confidence (0-1)"},"detection_method":{"type":"string","title":"Detection Method","description":"Detection method used"},"detection_rule":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Detection Rule","description":"Detection rule name"},"detected_at":{"type":"string","format":"date-time","title":"Detected At","description":"Detection timestamp"},"resolved_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Resolved At","description":"Resolution timestamp"},"additional_data":{"type":"object","title":"Additional Data","description":"Additional event data"}},"type":"object","required":["id","event_id","event_type","threat_level","status","title","description","risk_score","confidence","detection_method","detected_at","additional_data"],"title":"SecurityEventResponse","description":"Schema for security event response."},"SecurityHeadersCheck":{"properties":{"url":{"type":"string","title":"Url"},"headers":{"additionalProperties":{"type":"string"},"type":"object","title":"Headers"}},"type":"object","required":["url","headers"],"title":"SecurityHeadersCheck","description":"Security headers validation request."},"SecurityHeadersResponse":{"properties":{"secure":{"type":"boolean","title":"Secure"},"missing_headers":{"items":{"type":"string"},"type":"array","title":"Missing Headers"},"weak_headers":{"items":{"type":"string"},"type":"array","title":"Weak Headers"},"recommendations":{"items":{"type":"string"},"type":"array","title":"Recommendations"},"score":{"type":"integer","title":"Score"}},"type":"object","required":["secure","missing_headers","weak_headers","recommendations","score"],"title":"SecurityHeadersResponse","description":"Security headers validation response."},"SecurityMetricsResponse":{"properties":{"period_days":{"type":"integer","title":"Period Days","description":"Period covered in days"},"total_events":{"type":"integer","title":"Total Events","description":"Total security events"},"resolved_events":{"type":"integer","title":"Resolved Events","description":"Number of resolved events"},"resolution_rate":{"type":"number","title":"Resolution Rate","description":"Event resolution rate (0-1)"},"total_responses":{"type":"integer","title":"Total Responses","description":"Total threat responses"},"successful_responses":{"type":"integer","title":"Successful Responses","description":"Successful responses"},"response_success_rate":{"type":"number","title":"Response Success Rate","description":"Response success rate (0-1)"},"average_risk_score":{"type":"number","title":"Average Risk Score","description":"Average risk score"},"highest_risk_score":{"type":"number","title":"Highest Risk Score","description":"Highest risk score"},"threat_level_distribution":{"additionalProperties":{"type":"integer"},"type":"object","title":"Threat Level Distribution","description":"Events by threat level"}},"type":"object","required":["period_days","total_events","resolved_events","resolution_rate","total_responses","successful_responses","response_success_rate","average_risk_score","highest_risk_score","threat_level_distribution"],"title":"SecurityMetricsResponse","description":"Schema for security metrics and statistics."},"SimpleRegistrationRequest":{"properties":{"username":{"type":"string","maxLength":50,"minLength":3,"title":"Username","description":"Username"},"email":{"type":"string","format":"email","title":"Email","description":"Email address"},"password":{"type":"string","minLength":10,"title":"Password","description":"Login password"},"encryption_password":{"type":"string","minLength":10,"title":"Encryption Password","description":"Encryption password"},"full_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Full Name","description":"Full name"}},"type":"object","required":["username","email","password","encryption_password"],"title":"SimpleRegistrationRequest","description":"Schema for simplified registration request."},"SubjectType":{"type":"string","enum":["user","role"],"title":"SubjectType","description":"Enumeration of permission subject types."},"SystemHealthResponse":{"properties":{"status":{"type":"string","title":"Status","description":"Overall system status"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp","description":"Health check timestamp"},"components":{"additionalProperties":{"$ref":"#/components/schemas/ComponentStatus"},"type":"object","title":"Components","description":"Component statuses"}},"type":"object","required":["status","timestamp","components"],"title":"SystemHealthResponse","description":"Schema for system health response."},"SystemMetricsResponse":{"properties":{"timestamp":{"type":"string","format":"date-time","title":"Timestamp","description":"Metrics timestamp"},"cpu_usage":{"type":"number","title":"Cpu Usage","description":"CPU usage percentage"},"memory_usage":{"type":"number","title":"Memory Usage","description":"Memory usage percentage"},"disk_usage":{"type":"number","title":"Disk Usage","description":"Disk usage percentage"},"database_stats":{"additionalProperties":{"anyOf":[{"type":"integer"},{"type":"number"}]},"type":"object","title":"Database Stats","description":"Database statistics"},"activity_stats":{"additionalProperties":{"type":"integer"},"type":"object","title":"Activity Stats","description":"Activity statistics"},"uptime_seconds":{"type":"number","title":"Uptime Seconds","description":"System uptime in seconds"}},"type":"object","required":["timestamp","cpu_usage","memory_usage","disk_usage","database_stats","activity_stats","uptime_seconds"],"title":"SystemMetricsResponse","description":"Schema for system metrics response."},"SystemPermissionMatrix":{"properties":{"roles":{"items":{"$ref":"#/components/schemas/Role"},"type":"array","title":"Roles","description":"All system roles"},"permissions":{"items":{"$ref":"#/components/schemas/Permission"},"type":"array","title":"Permissions","description":"All system permissions"},"matrix":{"additionalProperties":{"items":{"type":"string"},"type":"array"},"type":"object","title":"Matrix","description":"Role -> Permission mappings"},"hierarchy":{"additionalProperties":{"type":"integer"},"type":"object","title":"Hierarchy","description":"Role hierarchy levels"}},"type":"object","required":["roles","permissions","matrix","hierarchy"],"title":"SystemPermissionMatrix","description":"Schema for system-wide permission matrix."},"TemplateApplicationRequest":{"properties":{"template_id":{"type":"string","title":"Template Id","description":"Template ID to apply"},"parent_folder_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Parent Folder Id","description":"Parent folder ID (null for root)"},"target_folder_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Target Folder Id","description":"Apply template to existing folder (alternative to creating new folder)"},"variables":{"allOf":[{"$ref":"#/components/schemas/TemplateVariables"}],"description":"Variable values"},"custom_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Custom Name","description":"Custom name for root folder (ignored if target_folder_id is provided)"},"apply_permissions":{"type":"boolean","title":"Apply Permissions","description":"Apply template permissions","default":true},"apply_tags":{"type":"boolean","title":"Apply Tags","description":"Apply template tags","default":true},"create_documents":{"type":"boolean","title":"Create Documents","description":"Create placeholder documents","default":false}},"type":"object","required":["template_id"],"title":"TemplateApplicationRequest","description":"Request to apply a template to create folder structure"},"TemplateApplicationResult":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether application succeeded"},"root_folder_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Root Folder Id","description":"ID of created root folder"},"created_folders":{"items":{"type":"integer"},"type":"array","title":"Created Folders","description":"IDs of all created folders"},"created_documents":{"items":{"type":"integer"},"type":"array","title":"Created Documents","description":"IDs of any created documents"},"errors":{"items":{"type":"string"},"type":"array","title":"Errors","description":"Any errors encountered"},"warnings":{"items":{"type":"string"},"type":"array","title":"Warnings","description":"Any warnings"}},"type":"object","required":["success"],"title":"TemplateApplicationResult","description":"Result of template application"},"TemplateCategory":{"type":"string","enum":["business","legal","development","marketing","hr","finance","research","event","general"],"title":"TemplateCategory","description":"Template categories for organization"},"TemplateCreateRequest":{"properties":{"name":{"type":"string","title":"Name","description":"Template name"},"description":{"type":"string","title":"Description","description":"Template description"},"category":{"allOf":[{"$ref":"#/components/schemas/TemplateCategory"}],"description":"Template category"},"icon":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Icon","description":"Icon name"},"color":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Color","description":"Color theme"},"structure":{"items":{"$ref":"#/components/schemas/FolderStructureItem-Input"},"type":"array","title":"Structure","description":"Folder structure"},"default_tags":{"items":{"type":"string"},"type":"array","title":"Default Tags"},"default_permissions":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Default Permissions"},"default_metadata":{"type":"object","title":"Default Metadata"},"variables":{"items":{"type":"string"},"type":"array","title":"Variables"},"allow_customization":{"type":"boolean","title":"Allow Customization","default":true}},"type":"object","required":["name","description","category","structure"],"title":"TemplateCreateRequest","description":"Request to create a new template"},"TemplateListResponse":{"properties":{"templates":{"items":{"$ref":"#/components/schemas/ProjectTemplate"},"type":"array","title":"Templates","description":"List of templates"},"total":{"type":"integer","title":"Total","description":"Total number of templates"},"categories":{"items":{"type":"string"},"type":"array","title":"Categories","description":"Available categories"}},"type":"object","required":["templates","total","categories"],"title":"TemplateListResponse","description":"Response for template listing"},"TemplatePreview":{"properties":{"template":{"allOf":[{"$ref":"#/components/schemas/ProjectTemplate"}],"description":"Template being previewed"},"preview_structure":{"items":{"type":"object"},"type":"array","title":"Preview Structure","description":"Preview of folder structure with resolved variables"},"estimated_folders":{"type":"integer","title":"Estimated Folders","description":"Number of folders that will be created"},"estimated_documents":{"type":"integer","title":"Estimated Documents","description":"Number of documents that will be created"},"resolved_variables":{"additionalProperties":{"type":"string"},"type":"object","title":"Resolved Variables","description":"Variable values that will be used"}},"type":"object","required":["template","preview_structure","estimated_folders","estimated_documents","resolved_variables"],"title":"TemplatePreview","description":"Preview of what a template will create"},"TemplateUpdateRequest":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name","description":"Template name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Template description"},"category":{"anyOf":[{"$ref":"#/components/schemas/TemplateCategory"},{"type":"null"}],"description":"Template category"},"icon":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Icon","description":"Icon name"},"color":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Color","description":"Color theme"},"structure":{"anyOf":[{"items":{"$ref":"#/components/schemas/FolderStructureItem-Input"},"type":"array"},{"type":"null"}],"title":"Structure","description":"Folder structure"},"default_tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Default Tags"},"default_permissions":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Default Permissions"},"default_metadata":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Default Metadata"},"variables":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Variables"},"allow_customization":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Allow Customization"}},"type":"object","title":"TemplateUpdateRequest","description":"Request to update an existing template"},"TemplateVariables":{"properties":{"project_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Project Name","description":"Project/client name"},"date":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date","description":"Current date"},"year":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Year","description":"Current year"},"month":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Month","description":"Current month"},"department":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Department","description":"Department name"},"custom_vars":{"additionalProperties":{"type":"string"},"type":"object","title":"Custom Vars","description":"Custom variables"}},"type":"object","title":"TemplateVariables","description":"Variables that can be used in template names and content"},"ThreatLevel":{"type":"string","enum":["low","medium","high","critical"],"title":"ThreatLevel","description":"Threat severity levels."},"TokenRefreshRequest":{"properties":{"refresh_token":{"type":"string","title":"Refresh Token","description":"Refresh token"}},"type":"object","required":["refresh_token"],"title":"TokenRefreshRequest","description":"Schema for token refresh request."},"TokenRefreshResponse":{"properties":{"access_token":{"type":"string","title":"Access Token","description":"New JWT access token"},"token_type":{"type":"string","title":"Token Type","description":"Token type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In","description":"Token expiration time in seconds"}},"type":"object","required":["access_token","expires_in"],"title":"TokenRefreshResponse","description":"Schema for token refresh response."},"UpdateSecurityEventRequest":{"properties":{"status":{"anyOf":[{"$ref":"#/components/schemas/EventStatus"},{"type":"null"}],"description":"New event status"},"resolution_notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resolution Notes","description":"Resolution notes"}},"type":"object","title":"UpdateSecurityEventRequest","description":"Schema for updating a security event."},"UserActivityResponse":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"User ID"},"username":{"type":"string","title":"Username","description":"Username"},"period_days":{"type":"integer","title":"Period Days","description":"Period covered in days"},"statistics":{"additionalProperties":{"anyOf":[{"type":"integer"},{"type":"string"},{"type":"null"}]},"type":"object","title":"Statistics","description":"Activity statistics"},"recent_activity":{"items":{"type":"object"},"type":"array","title":"Recent Activity","description":"Recent activity log"}},"type":"object","required":["user_id","username","period_days","statistics","recent_activity"],"title":"UserActivityResponse","description":"Schema for user activity response."},"UserCreate":{"properties":{"username":{"type":"string","maxLength":50,"minLength":3,"title":"Username","description":"Username"},"email":{"type":"string","format":"email","title":"Email","description":"Email address"},"password":{"type":"string","minLength":8,"title":"Password","description":"Login password"},"encryption_password":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Encryption Password","description":"Encryption password for zero-knowledge storage (defaults to login password if not provided)"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether user is active","default":true},"is_verified":{"type":"boolean","title":"Is Verified","description":"Whether user email is verified","default":false}},"type":"object","required":["username","email","password"],"title":"UserCreate","description":"Schema for creating a new user."},"UserListResponse":{"properties":{"users":{"items":{"$ref":"#/components/schemas/UserResponse"},"type":"array","title":"Users","description":"List of users"},"total":{"type":"integer","title":"Total","description":"Total number of users"},"page":{"type":"integer","title":"Page","description":"Current page number"},"size":{"type":"integer","title":"Size","description":"Page size"},"has_next":{"type":"boolean","title":"Has Next","description":"Whether there are more pages"}},"type":"object","required":["users","total","page","size","has_next"],"title":"UserListResponse","description":"Schema for paginated user list response."},"UserPermissionSummary":{"properties":{"user_id":{"type":"integer","title":"User Id"},"username":{"type":"string","title":"Username"},"primary_role":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Primary Role","description":"Primary role name"},"all_roles":{"items":{"type":"string"},"type":"array","title":"All Roles","description":"All assigned role names"},"permission_count":{"type":"integer","title":"Permission Count","description":"Total number of permissions"},"highest_hierarchy_level":{"type":"integer","title":"Highest Hierarchy Level","description":"Highest role hierarchy level"},"last_login":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Login"}},"type":"object","required":["user_id","username","all_roles","permission_count","highest_hierarchy_level"],"title":"UserPermissionSummary","description":"Schema for user permission summary."},"UserResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"User ID"},"username":{"type":"string","title":"Username","description":"Username"},"email":{"type":"string","title":"Email","description":"Email address"},"first_name":{"type":"string","title":"First Name","description":"First name (placeholder)","default":""},"last_name":{"type":"string","title":"Last Name","description":"Last name (placeholder)","default":""},"is_active":{"type":"boolean","title":"Is Active","description":"Whether user is active"},"is_verified":{"type":"boolean","title":"Is Verified","description":"Whether user email is verified"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp"},"last_login":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Login","description":"Last login timestamp"},"login_count":{"type":"integer","title":"Login Count","description":"Number of logins","default":0},"is_mfa_enabled":{"type":"boolean","title":"Is Mfa Enabled","description":"Whether MFA is enabled","default":false}},"type":"object","required":["id","username","email","is_active","is_verified","created_at","updated_at"],"title":"UserResponse","description":"Schema for user response data."},"UserRoleAssignment":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"ID of the user"},"role_id":{"type":"integer","title":"Role Id","description":"ID of the role"},"is_primary":{"type":"boolean","title":"Is Primary","description":"Whether this is the user's primary role","default":true},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"When this role assignment expires"}},"type":"object","required":["user_id","role_id"],"title":"UserRoleAssignment","description":"Schema for user role assignment requests."},"UserRoleAssignmentResponse":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"ID of the user"},"role_id":{"type":"integer","title":"Role Id","description":"ID of the role"},"is_primary":{"type":"boolean","title":"Is Primary","description":"Whether this is the user's primary role","default":true},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At","description":"When this role assignment expires"},"assigned_at":{"type":"string","format":"date-time","title":"Assigned At"},"assigned_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Assigned By","description":"ID of user who made the assignment"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether this assignment is active"},"role":{"allOf":[{"$ref":"#/components/schemas/Role"}],"description":"Role details"}},"type":"object","required":["user_id","role_id","assigned_at","is_active","role"],"title":"UserRoleAssignmentResponse","description":"Schema for user role assignment responses."},"UserRoleListResponse":{"properties":{"user_roles":{"items":{"$ref":"#/components/schemas/UserRoleAssignmentResponse"},"type":"array","title":"User Roles"},"total":{"type":"integer","title":"Total","description":"Total number of role assignments"},"user_id":{"type":"integer","title":"User Id","description":"User ID"},"username":{"type":"string","title":"Username","description":"Username"}},"type":"object","required":["user_roles","total","user_id","username"],"title":"UserRoleListResponse","description":"Schema for user role list responses."},"UserUpdate":{"properties":{"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email","description":"Email address"},"password":{"anyOf":[{"type":"string","minLength":8},{"type":"null"}],"title":"Password","description":"New password"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active","description":"Whether user is active"},"is_verified":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Verified","description":"Whether user email is verified"}},"type":"object","title":"UserUpdate","description":"Schema for updating an existing user."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"ZeroKnowledgeRegistrationRequest":{"properties":{"username":{"type":"string","maxLength":50,"minLength":3,"title":"Username","description":"Username"},"email":{"type":"string","format":"email","title":"Email","description":"Email address"},"password":{"type":"string","minLength":10,"title":"Password","description":"Login password"},"full_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Full Name","description":"Full name"},"encryption_salt":{"type":"string","title":"Encryption Salt","description":"Base64 encoded salt for PBKDF2 (32 bytes)"},"key_verification_payload":{"type":"string","title":"Key Verification Payload","description":"Encrypted verification payload"},"encryption_method":{"type":"string","title":"Encryption Method","description":"Key derivation method","default":"PBKDF2-SHA256"},"key_derivation_iterations":{"type":"integer","minimum":100000.0,"title":"Key Derivation Iterations","description":"PBKDF2 iterations","default":500000}},"type":"object","required":["username","email","password","encryption_salt","key_verification_payload"],"title":"ZeroKnowledgeRegistrationRequest","description":"Schema for zero-knowledge registration request."},"ZeroKnowledgeRegistrationResponse":{"properties":{"message":{"type":"string","title":"Message","description":"Success message"},"user_id":{"type":"integer","title":"User Id","description":"Created user ID"},"username":{"type":"string","title":"Username","description":"Username"},"encryption_configured":{"type":"boolean","title":"Encryption Configured","description":"Whether encryption is configured","default":true}},"type":"object","required":["message","user_id","username"],"title":"ZeroKnowledgeRegistrationResponse","description":"Schema for zero-knowledge registration response."},"app__api__v1__key_management__KeyDerivationRequest":{"properties":{"purpose":{"type":"string","title":"Purpose"},"context":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Context"}},"type":"object","required":["purpose"],"title":"KeyDerivationRequest"},"app__schemas__encryption__KeyDerivationRequest":{"properties":{"password":{"type":"string","title":"Password","description":"Password for key derivation"},"salt":{"type":"string","title":"Salt","description":"Base64 encoded salt"},"iterations":{"type":"integer","minimum":100000.0,"title":"Iterations","description":"PBKDF2 iterations"}},"type":"object","required":["password","salt","iterations"],"title":"KeyDerivationRequest","description":"Request schema for key derivation.","example":{"iterations":500000,"password":"SecurePassword123!","salt":"base64encodedSalt=="}}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}